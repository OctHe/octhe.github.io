<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Shell Cottage</title>

<meta name="description" content="Shell Cottage">
<meta name="keywords" content="Shell Cottage">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="#index" rel="start" title="index">
<link href="#Distribution" rel="next" title="Distribution">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
span:hover a.copiable-link {visibility: visible}
ul.mark-bullet {list-style-type: disc}
ul.mark-minus {list-style-type: "\2212"}
-->
</style>


</head>

<body lang="en">

<div class="top-level-extent" id="index">
<div class="nav-panel">
<p>
Next: <a href="#Distribution" accesskey="n" rel="next">Distribution</a> &nbsp; </p>
</div>
<h1 class="top" id="Contents"><span>Contents<a class="copiable-link" href="#Contents"> &para;</a></span></h1>

<p>This is a personal blog website that named as Shell Cottage.
The blog focuses on Linux platform and wireless network.
</p>
<ul class="mini-toc">
<li><a href="#Distribution" accesskey="1">Distribution</a></li>
<li><a href="#Desktop-Enviornment" accesskey="2">Desktop Environment</a></li>
<li><a href="#System" accesskey="3">System Management</a></li>
<li><a href="#Kernel" accesskey="4">Kernel</a></li>
<li><a href="#Blog" accesskey="5">Blog</a></li>
<li><a href="#Shell" accesskey="6">Shell</a></li>
<li><a href="#Editor" accesskey="7">Editor</a></li>
<li><a href="#Version-Control" accesskey="8">Version Control</a></li>
<li><a href="#Server" accesskey="9">Server</a></li>
<li><a href="#Network">Network</a></li>
<li><a href="#SDR">SDR</a></li>
<li><a href="#Input-Method">Input Method</a></li>
</ul>
<hr>
<div class="chapter-level-extent" id="Distribution">
<div class="nav-panel">
<p>
Next: <a href="#Desktop-Enviornment" accesskey="n" rel="next">Desktop Environment</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Distribution-1"><span>1 Distribution<a class="copiable-link" href="#Distribution-1"> &para;</a></span></h2>

<p>Linux contains lots of well-known distributions.
A Linux distribtuion comprises multiple drivers to support different hardware architectures and a collections of softwares in the user sapce.
The follow tables summarize the main different between these awesome distributions and the programs.
</p>
<table class="multitable">
<thead><tr><th width="20%"></th><th width="20%">Arch</th><th width="20%">Debian</th><th width="20%">Fedora</th></tr></thead>
<tbody><tr><td width="20%">Default desktop</td><td width="20%">-</td><td width="20%">GNOME</td><td width="20%">GNOME</td></tr>
<tr><td width="20%">Init system</td><td width="20%">systemd</td><td width="20%">systemd</td><td width="20%">systemd</td></tr>
<tr><td width="20%">Package manager</td><td width="20%">pacman</td><td width="20%">apt</td><td width="20%">dnf</td></tr>
<tr><td width="20%">C library</td><td width="20%">glibc</td><td width="20%">glibc</td><td width="20%">glibc</td></tr>
<tr><td width="20%">Utility</td><td width="20%">coreutils</td><td width="20%">coreutils</td><td width="20%">coreutils</td></tr>
<tr><td width="20%">Installer</td><td width="20%">CLI</td><td width="20%">Debian-Installer</td><td width="20%">Anaconda</td></tr>
</tbody>
</table>

<table class="multitable">
<thead><tr><th width="20%"></th><th width="20%">NixOS</th><th width="20%">Void</th><th width="20%">Deepin</th></tr></thead>
<tbody><tr><td width="20%">Default desktop</td><td width="20%">GNOME</td><td width="20%">xfce</td><td width="20%">DDE</td></tr>
<tr><td width="20%">Init system</td><td width="20%">systemd</td><td width="20%">runit</td><td width="20%">systemd</td></tr>
<tr><td width="20%">Package manager</td><td width="20%">Nix</td><td width="20%">xbps</td><td width="20%">-</td></tr>
<tr><td width="20%">C library</td><td width="20%">glibc</td><td width="20%">musl</td><td width="20%">glibc</td></tr>
<tr><td width="20%">Utility</td><td width="20%">coreutils</td><td width="20%">coreutils</td><td width="20%">coreutils</td></tr>
<tr><td width="20%">Installer</td><td width="20%">Calamares</td><td width="20%">CLI</td><td width="20%">deepin-installer</td></tr>
</tbody>
</table>

<p>The distributions for embeded devices
</p>
<table class="multitable">
<thead><tr><th width="20%"></th><th width="20%">Openwrt</th><th width="20%">Alpine</th></tr></thead>
<tbody><tr><td width="20%">Init system</td><td width="20%">init</td><td width="20%">OpenRC</td></tr>
<tr><td width="20%">Package manager</td><td width="20%">opkg</td><td width="20%">apk</td></tr>
<tr><td width="20%">Utility</td><td width="20%">Busybox</td><td width="20%">Busybox</td></tr>
</tbody>
</table>

<ul class="mini-toc">
<li><a href="#Package-Manager" accesskey="1">Package Manager</a></li>
<li><a href="#Init-Process" accesskey="2">Init Process</a></li>
<li><a href="#Linux-To-Go" accesskey="3">Linux To Go</a></li>
<li><a href="#Multi_002dOS-Installation" accesskey="4">Multi-OS Installation</a></li>
</ul>
<div class="section-level-extent" id="Package-Manager">
<h3 class="section"><span>1.1 Package Manager<a class="copiable-link" href="#Package-Manager"> &para;</a></span></h3>

<p>The follow lists common package managers that in different distributions.
</p><ul class="itemize mark-bullet">
<li>apt
</li><li>dnf
</li><li>pacman
</li><li>zypper
</li><li>Flatpak
</li><li>AppImage
</li></ul>

<ul class="mini-toc">
<li><a href="#dnf" accesskey="1">dnf</a></li>
<li><a href="#zypper" accesskey="2">zypper</a></li>
<li><a href="#Flatpak" accesskey="3">Flatpak</a></li>
</ul>
<div class="subsection-level-extent" id="dnf">
<h4 class="subsection"><span>1.1.1 dnf<a class="copiable-link" href="#dnf"> &para;</a></span></h4>

<p>dnf or Dandified YUM is the next-generation of the Fedora package manger yum.
It manages rpm packages.
</p>
<p>The source files of an rpm package are in the *.src.rpm.
</p>
<div class="example">
<pre class="example-preformatted"># Download the src.rpm
dnf download --source &lt;package name&gt;
# List the infomation in the *src.rpm
rpm -ql *.src.rpm 
# Extract the *src.rpm
rpm2cpio *.src.rpm | cpio -idv
# Install source code from *src.rpm to home directory
rpm -i *src.rpm
# Rebuild the source package if it is patched
rpmbuild -bb /spec/director/package.spec
</pre></div>

</div>
<div class="subsection-level-extent" id="zypper">
<h4 class="subsection"><span>1.1.2 zypper<a class="copiable-link" href="#zypper"> &para;</a></span></h4>

<p>openSUSE uses <code class="code">zypper</code> as the default package manager.
It is based on RPM, which is similar to Fedora.
zypper uses repository for packages.
<code class="code">zypper repos</code> lists repositories.
Search all installed packages in a target repo, use <code class="code">zypper search -i -r &lt;repo&gt;</code>.
</p>
<p>Besides installation of the built programs, zypper also provides an offical repository for the source code.
As an example, the download and build process for the <code class="code">hostapd</code> is
</p>
<div class="example">
<pre class="example-preformatted">sudo zypper source-install hostapd  # or `sudo zypper si hostapd`
cd /usr/src/packages/       # cd to the default directory for source code
ls SOURCES
ls SPECS
sudo zypper in rpmbuild     # The build tool of the download source code
sudo rpmbuild -ba SPECS/hostapd.spec  # -ba means to perform a full build.
ls RPMS/x86_64              # The built program in the x86 architecture
sudo rpmbuild -ba --noclean SPECS/hostapd.spec    # It does not remove the extracted source code
ls BUILD                    # The extracted source code
</pre></div>

<p>openSUSE also provides a command-line tool for package download, building and packaging.
The name of the tool is osc, which means openSUSE commander.
To use it, run
</p>
<p><code class="code">sudo zypper install osc</code>
</p>
</div>
<div class="subsection-level-extent" id="Flatpak">
<h4 class="subsection"><span>1.1.3 Flatpak<a class="copiable-link" href="#Flatpak"> &para;</a></span></h4>

<p>Flatpak is a cross-platform package manager that run applications in a sandbox.
It can download apps from FlatHub, which is the official repository of Flatpak.
</p>
<p><code class="code">flatpak install &lt;package name/ID&gt;</code>
</p>
<p>Different from apt/zypper/dnf/pacman, you cannot run the applications from flatpak directly.
</p>
<p><code class="code">flatpak run &lt;package name/ID&gt;</code>
</p>
</div>
</div>
<div class="section-level-extent" id="Init-Process">
<h3 class="section"><span>1.2 Init Process<a class="copiable-link" href="#Init-Process"> &para;</a></span></h3>

<p>In Linux, the first process is usually *init* or *systemd*.
They both work to manage the initialization of the system before the login shell.
The PID of them is 1, which means the first process after the kernel.
</p>
<ul class="mini-toc">
<li><a href="#System-V-and-init" accesskey="1">System V and init</a></li>
<li><a href="#systemd" accesskey="2">systemd</a></li>
</ul>
<div class="subsection-level-extent" id="System-V-and-init">
<h4 class="subsection"><span>1.2.1 System V and init<a class="copiable-link" href="#System-V-and-init"> &para;</a></span></h4>

<p>init is the initial script in System V project.
In a early version of a Linux distribution, it usually uses init as the initalization system.
It finds the configuration file in <code class="code">/etc/inittab</code> and runs the scripts in <code class="code">/etc/rc</code> according to the runlevel.
Different runlevels means different modes of init.
It will run the corresponding runlevel scripts in <code class="code">/etc/rcN.d/</code>, where N means the runlevel.
The value of N is from 0 to 6.
All scripts under these directories are a symbolic link to a file in <code class="code">etc/init.d/</code>.
The file started with &quot;S&quot; means &quot;start it&quot;, while &quot;K&quot; means &quot;kill it&quot;.
The feature of init is run all script in a fixed order one-by-one, so it is easy to find the error, while costs lots of time.
</p>
</div>
<div class="subsection-level-extent" id="systemd">
<h4 class="subsection"><span>1.2.2 systemd<a class="copiable-link" href="#systemd"> &para;</a></span></h4>

<p>In contrast, systemd concurrently runs all scripts.
Ubuntu and OpenSUSE have been support systemd and their would have other distributions.
In a system that initialized with systemd.
The init file, which is <code class="code">/usr/sbin/init</code> will be a symbolic to the <code class="code">/lib/systemd/systemd</code>.
The default configuration file of systemd is <code class="code">/usr/lib/systemd/system/default.target</code>, which is also a symbolic link to <code class="code">/usr/lib/systemd/system/graphical.target</code>.
You can find the default target with
</p>
<p><code class="code">systemctl get-default</code>
</p>
</div>
</div>
<div class="section-level-extent" id="Linux-To-Go">
<h3 class="section"><span>1.3 Linux To Go<a class="copiable-link" href="#Linux-To-Go"> &para;</a></span></h3>

<p>Linux To Go (LTG) is a method to install Linux in external USB disk.
The main advantage of LTG is to boot your owe system in multiple computers that have same architecture (for example, x86 system).
</p>
<p>The LTG is based on Fedora since it has stable version, so it does not need to be updated frequently.
The boot method is UEFI, so allocate a partition with 1 GiB to support UEFI.
In addition, install the bootloader to the USB disk.
After that, the installation process is the same as a normal installation in any disk.
</p>
</div>
<div class="section-level-extent" id="Multi_002dOS-Installation">
<h3 class="section"><span>1.4 Multi-OS Installation<a class="copiable-link" href="#Multi_002dOS-Installation"> &para;</a></span></h3>

<p>Install multiple OSs is simple since lots-of OSs have a GUI installer.
In most time, someone does not need to install the OS in the hardware, if he only want to try it at first.
This section summarizes the content about Live USB and Disk layout.
</p>
<ul class="mini-toc">
<li><a href="#Live-USB" accesskey="1">Live USB</a></li>
<li><a href="#Disk-Partition" accesskey="2">Disk Partition</a></li>
<li><a href="#Update-grub" accesskey="3">Update grub</a></li>
<li><a href="#Reinstallation" accesskey="4">Reinstallation</a></li>
</ul>
<div class="subsection-level-extent" id="Live-USB">
<h4 class="subsection"><span>1.4.1 Live USB<a class="copiable-link" href="#Live-USB"> &para;</a></span></h4>

<p>The first thing of installation OSs is having a Live USB that contains multiple ISOs.
<a class="url" href="https://www.ventoy.net/en/index.html">Vectoy</a> is an open-source tool that can load multiple Live USBs
The USB with Ventoy also can be used for backup files.
</p>
<p>The only drawback of ventoy is the grub may have a incorrect boot configuration.
This makes the installed OS can be boot with recovery mode but cannot boot with the normal mode.
To avoid this, just edit the grub (type &lsquo;e&lsquo; when boot) and delete the command &lsquo;rdinit=/vtoy/vtoy&lsquo;.
</p>
</div>
<div class="subsection-level-extent" id="Disk-Partition">
<h4 class="subsection"><span>1.4.2 Disk Partition<a class="copiable-link" href="#Disk-Partition"> &para;</a></span></h4>

<p>Most Linux distributions provides a GUI installer, so the installation is quite easy.
The only thing worth noting is carefully about the disk partition without formating the partition and lossing data.
Usually, all the home directories of all OSs can be listed in the same partition with different folders.
An example partition can be as follows
</p>
<ul class="itemize mark-bullet">
<li>nvme0n1
    <ul class="itemize mark-minus">
<li>nvme0n1p1 (512 MB)
        <ul class="itemize mark-minus">
<li>/boot/efi
        </li></ul>
</li><li>nvme0n1p2 (16 GB)
        <ul class="itemize mark-minus">
<li>/swap
        </li></ul>
</li><li>nvme0n1p3 (500 GB)
        <ul class="itemize mark-minus">
<li>/home
            <ul class="itemize mark-minus">
<li>/home/user_ubuntu
            </li><li>/home/user_suse
            </li><li>/home/user_arch
            </li><li>... 
            </li></ul>
</li></ul>
</li><li>nvme0n1p4 (100 GB)
        <ul class="itemize mark-minus">
<li>/       # root for Ubuntu
        </li></ul>
</li><li>nvme0n1p5 (100 GB)
        <ul class="itemize mark-minus">
<li>/       # root for OpenSUSE
        </li></ul>
</li><li>...
    </li></ul>
</li></ul>

<p>The most important thing is: DON&rsquo;T FORMAT the home directory in nvme0n1p3 and the /boot/efi directory in nvme0n1p1 when install a new OS.
This partition can provide the capability to reinstall all OSs without affecting the user data.
</p>
</div>
<div class="subsection-level-extent" id="Update-grub">
<h4 class="subsection"><span>1.4.3 Update grub<a class="copiable-link" href="#Update-grub"> &para;</a></span></h4>

<p>After a new installation, it is better to update the grub at any OSs.
The follow command can be used only once at one of the OSs.
In Debian, use
</p>    
<p><code class="code">sudo grub-mkconfig -o /boot/grub/grub.cfg</code>
<code class="code">sudo grub-install /nvme0n1</code>
</p>
<p>In OpenSUSE, use
</p>    
<p><code class="code">sudo grub2-mkconfig -o /boot/grub/grub.cfg</code>
<code class="code">sudo grub2-install /nvme0n1</code>
</p>
</div>
<div class="subsection-level-extent" id="Reinstallation">
<h4 class="subsection"><span>1.4.4 Reinstallation<a class="copiable-link" href="#Reinstallation"> &para;</a></span></h4>

<p>Most time there is no need to reinstall my OSs, but sometimes the OS cannot be boot due to strange issues.
In this time, the OS can be reinstalled with the same partition and user name as the old version.
For example, the root of the new ubuntu will be listed in nvme0n1p4, and the /home will be listed in nvme01n1p3.
The user name is &rsquo;user_ubuntu&rsquo;, so the configuration of the old OS can be reused for the new OS.
</p>
<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Desktop-Enviornment">
<div class="nav-panel">
<p>
Next: <a href="#System" accesskey="n" rel="next">System Management</a>, Previous: <a href="#Distribution" accesskey="p" rel="prev">Distribution</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Desktop-Environment"><span>2 Desktop Environment<a class="copiable-link" href="#Desktop-Environment"> &para;</a></span></h2>

<p>A Linux distribution usually has two types of interfaces.
One of them is virtual console (CLI) and the other is GUI.
Virtual console is the default interface from Linux kernel and does not support Unicode.
For example, in Debian/Ubuntu, type <code class="code">&lt;ctrl&gt;+&lt;alt&gt;+F{1-6}</code> can change between virtual console and GUI.
Specifically, <code class="code">&lt;ctrl&gt;+&lt;alt&gt;+F2</code> can change to the GUI, and <code class="code">&lt;ctrl&gt;+&lt;alt&gt;+F{3,4,5,6}</code> are different virtual consoles.
Desktop environment is a collection of GUI programs that replaces CLI and is one of the most complicated subsystem in Linux.
It breaks up the limitation of shell and provides a more flexiable interface for users.
By default, the startup program, i.e., systemd, will initialize the GUI desktop.
The desktop also can be opened manually. 
For example, <code class="code">sudo startx</code> is the command to start an x11 service.
x11 and Wayland are two communication protocol that relates a display server and the client.
Most of the desktop and libraries are based on them.
</p>
<p>Graphicless compares the follow open-source desktop environments.
</p>
<table class="multitable">
<thead><tr><th width="25%"></th><th width="25%">KDE</th><th width="25%">GNOME</th><th width="25%">xfce</th></tr></thead>
<tbody><tr><td width="25%">Toolkit</td><td width="25%">QT</td><td width="25%">GTK</td><td width="25%">GTK</td></tr>
<tr><td width="25%">Display manager</td><td width="25%">SDDM</td><td width="25%">gdm</td><td width="25%">LightDM</td></tr>
<tr><td width="25%">Session manager</td><td width="25%">ksmserver</td><td width="25%">gnome-session</td><td width="25%">xfce4-session</td></tr>
<tr><td width="25%">Windows manager</td><td width="25%">KWin</td><td width="25%">gnome-shell</td><td width="25%">xfwm4</td></tr>
<tr><td width="25%">Desktop manager</td><td width="25%">-</td><td width="25%">-</td><td width="25%">xfdesktop</td></tr>
<tr><td width="25%">File manager</td><td width="25%">Dolphin</td><td width="25%">Nautilus</td><td width="25%">Thunar</td></tr>
<tr><td width="25%">Launcher</td><td width="25%">Kickoff</td><td width="25%">-</td><td width="25%">xfce-panel</td></tr>
<tr><td width="25%">Editor</td><td width="25%">Kate</td><td width="25%">gnome-text-editor</td><td width="25%">Mousepad</td></tr>
<tr><td width="25%">Terminal</td><td width="25%">Konsole</td><td width="25%">gnome-terminal</td><td width="25%">xfce4-terminal</td></tr>
<tr><td width="25%">Network</td><td width="25%">Network Manager</td><td width="25%">Network Manager</td><td width="25%">-</td></tr>
<tr><td width="25%">Capturer</td><td width="25%">Spectacle</td><td width="25%">GNOME Screenshot</td><td width="25%">xfce4-screenshooter</td></tr>
<tr><td width="25%">Document viewer</td><td width="25%">Okular</td><td width="25%">Evince</td><td width="25%">-</td></tr>
<tr><td width="25%">Image viewer</td><td width="25%">Gwenview</td><td width="25%">Loupe</td><td width="25%">Ristretto</td></tr>
<tr><td width="25%">Input method</td><td width="25%">-</td><td width="25%">-</td><td width="25%">-</td></tr>
<tr><td width="25%">Advanced setting</td><td width="25%">-</td><td width="25%">gnome-tweaks</td><td width="25%">-</td></tr>
<tr><td width="25%">Development</td><td width="25%">KDevelop</td><td width="25%">GNOME Builder</td><td width="25%">-</td></tr>
</tbody>
</table>

<table class="multitable">
<thead><tr><th width="20%"></th><th width="40%">LXQT</th><th width="40%">DDE</th></tr></thead>
<tbody><tr><td width="20%">Toolkit</td><td width="40%">QT</td><td width="40%">QT</td></tr>
<tr><td width="20%">Display manager</td><td width="40%">SDDM</td><td width="40%">LightDM</td></tr>
<tr><td width="20%">Session manager</td><td width="40%">lxqt-session</td><td width="40%">dde-session</td></tr>
<tr><td width="20%">Windows manager</td><td width="40%">Openbox</td><td width="40%">Treeland</td></tr>
<tr><td width="20%">Desktop manager</td><td width="40%">-</td><td width="40%">-</td></tr>
<tr><td width="20%">File manager</td><td width="40%">PcManFm-qt</td><td width="40%">dde-file-manager</td></tr>
<tr><td width="20%">Launcher</td><td width="40%">lxqt-runner</td><td width="40%">dde-launcher</td></tr>
<tr><td width="20%">Editor</td><td width="40%">-</td><td width="40%">deepin-editor</td></tr>
<tr><td width="20%">Terminal</td><td width="40%">QTerminal</td><td width="40%">deepin-terminal</td></tr>
<tr><td width="20%">Network</td><td width="40%">-</td><td width="40%">-</td></tr>
<tr><td width="20%">Capturer</td><td width="40%">Screengrab</td><td width="40%">deepin-screenshot</td></tr>
<tr><td width="20%">Document viewer</td><td width="40%">-</td><td width="40%">deepin-reader</td></tr>
<tr><td width="20%">Image viewer</td><td width="40%">Lximage-qt</td><td width="40%">deepin-image-viewer</td></tr>
<tr><td width="20%">Input method</td><td width="40%">-</td><td width="40%">deepin-im</td></tr>
<tr><td width="20%">Advanced setting</td><td width="40%">-</td><td width="40%">deepin-tweak</td></tr>
<tr><td width="20%">Development</td><td width="40%">-</td><td width="40%">Deepin-IDE</td></tr>
</tbody>
</table>

<ul class="mini-toc">
<li><a href="#GNOME" accesskey="1">GNOME</a></li>
<li><a href="#xfce4" accesskey="2">xfce4</a></li>
<li><a href="#Window-Manager" accesskey="3">Window Manager</a></li>
<li><a href="#tmux" accesskey="4">tmux</a></li>
</ul>
<div class="section-level-extent" id="GNOME">
<h3 class="section"><span>2.1 GNOME<a class="copiable-link" href="#GNOME"> &para;</a></span></h3>

<ul class="mini-toc">
<li><a href="#Advanced-Setting" accesskey="1">Advanced Setting</a></li>
</ul>
<div class="subsection-level-extent" id="Advanced-Setting">
<h4 class="subsection"><span>2.1.1 Advanced Setting<a class="copiable-link" href="#Advanced-Setting"> &para;</a></span></h4>

<p>gnome-tweaks gives advanced settings for gnome.
It support swap of Caplock and Ctrl.
Download it in Debian with
</p>
<p><code class="code">sudo apt install gnome-tweaks</code>
</p>
<p>This swap is only useful in gnome-based GUI.
Windows has a similar tool that named as [PowerToys](https://github.com/microsoft/PowerToys).
</p>
</div>
</div>
<div class="section-level-extent" id="xfce4">
<h3 class="section"><span>2.2 xfce4<a class="copiable-link" href="#xfce4"> &para;</a></span></h3>

<p>Graphicless tests xfce4 in Debian 12.
It uses xfce4-terminal and firefox as the default applications for terminal and web browser, respectively.
</p>
</div>
<div class="section-level-extent" id="Window-Manager">
<h3 class="section"><span>2.3 Window Manager<a class="copiable-link" href="#Window-Manager"> &para;</a></span></h3>

<table class="multitable">
<thead><tr><th width="20%"></th><th width="20%">Openbox</th><th width="20%">i3</th><th width="20%">xmonad</th><th width="20%">sway</th></tr></thead>
<tbody><tr><td width="20%">Protocol</td><td width="20%">x11</td><td width="20%">x11</td><td width="20%">Wayland</td><td width="20%">Wayland</td></tr>
</tbody>
</table>

<ul class="mini-toc">
<li><a href="#Openbox" accesskey="1">Openbox</a></li>
</ul>
<div class="subsection-level-extent" id="Openbox">
<h4 class="subsection"><span>2.3.1 Openbox<a class="copiable-link" href="#Openbox"> &para;</a></span></h4>

<p>Install Openbox with apt
</p>
<p><code class="code">sudo apt install openbox</code>
</p>
<p>By default, openbox has a refresh issue in Ubuntu.
The applications will not automatic refresh after opening them.
To fix this, change the configuration file
</p>
<p><code class="code">sudo vim /usr/lib/x86_64-linux-gnu/openbox-autostart</code>
</p>
<p>Uncommand the line 
<code class="code">test -z $BG || $BG -solid &quot;#303030&quot;</code>
</p>
</div>
</div>
<div class="section-level-extent" id="tmux">
<h3 class="section"><span>2.4 tmux<a class="copiable-link" href="#tmux"> &para;</a></span></h3>

<p>Tmux is a famous terminal multiplexer.
It works like a window manager in terminal.
This is only part of the common keys and commands for tmux.
To read the full list, use <code class="code">man tmux</code> or type <code class="code">&lt;C-b&gt; + ?</code>.
The keybindings are in the &quot;DEFAULT KEY BINDINGS&quot; section.
</p>
<p><code class="code">&lt;C-b&gt;</code> is the default prefix key of tmux.
The follow shortcuts omit the prefix key.
</p>
<ul class="mini-toc">
<li><a href="#Normal-mode" accesskey="1">Normal mode</a></li>
<li><a href="#Copy-mode" accesskey="2">Copy mode</a></li>
<li><a href="#Command-line-mode" accesskey="3">Command line mode</a></li>
</ul>
<div class="subsection-level-extent" id="Normal-mode">
<h4 class="subsection"><span>2.4.1 Normal mode<a class="copiable-link" href="#Normal-mode"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    # Session
    d       # Detach the window from the session
    s       # Select a new session
    (/)     # Move to the previous/next session

    tmux ls/list                            # List sessions
    tmux attach/detach                      # Attach/Detach the window to the session
    tmux kill-session -t &lt;session-name&gt;     # Close (Kill) the session

    # Window
    c       # Create new window
    l       # Toggle last active window
    n/p     # Next/Previous window
    w       # List windows

    tmux new -s &lt;session-name&gt;              # Create a new window for the session

    # Pane
    o             # Go to next pane
    q &lt;num&gt;       # Switch to the pane
    x             # Close the pane
    z             # Toggle pane zoom
    { or }      # Move the pane to left/right
    % or &quot;        # Split pane with vertical/horizontal
    &lt;Up&gt;/&lt;Down&gt;/&lt;Left&gt;/&lt;right&gt;          # Go to the up/down/left/right pane

</pre></div>

</div>
<div class="subsection-level-extent" id="Copy-mode">
<h4 class="subsection"><span>2.4.2 Copy mode<a class="copiable-link" href="#Copy-mode"> &para;</a></span></h4>

<p>In copy mode, user can view the contents in tmux pane.
The user also can use vim-like commands to view and copy the content.
</p><div class="example">
<pre class="example-preformatted">    [       # Enter copy mode.
</pre></div>

</div>
<div class="subsection-level-extent" id="Command-line-mode">
<h4 class="subsection"><span>2.4.3 Command line mode<a class="copiable-link" href="#Command-line-mode"> &para;</a></span></h4>

<p>The follow key does not need prefix key.
</p>
<div class="example">
<pre class="example-preformatted">    :       # Enter command-line mode
</pre></div>

<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="System">
<div class="nav-panel">
<p>
Next: <a href="#Kernel" accesskey="n" rel="next">Kernel</a>, Previous: <a href="#Desktop-Enviornment" accesskey="p" rel="prev">Desktop Environment</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="System-Management"><span>3 System Management<a class="copiable-link" href="#System-Management"> &para;</a></span></h2>

<p>Tools to manage Linux.
</p>
<ul class="mini-toc">
<li><a href="#smartctl" accesskey="1">smartctl</a></li>
<li><a href="#top" accesskey="2">top</a></li>
</ul>
<div class="section-level-extent" id="smartctl">
<h3 class="section"><span>3.1 smartctl<a class="copiable-link" href="#smartctl"> &para;</a></span></h3>

<p>SMART is a tool to check the health of disk.
&quot;SMART&quot; means Self-Monitoring, Analysis and Report Technology.
The command is &quot;smartctl&quot;.
To run it, type the command with <code class="code">sudo</code> privilege.
</p>
<p><code class="code">sudo smartctl -H /dev/nvme0n1   # Show device SMART health status</code>
</p>
</div>
<div class="section-level-extent" id="top">
<h3 class="section"><span>3.2 top<a class="copiable-link" href="#top"> &para;</a></span></h3>

<ul class="itemize mark-bullet">
<li>us      uniced user process
</li><li>sy      system process
</li><li>ni      niced user process
</li><li>id      kernel idle handler
</li><li>wa      waiting for I/O completion
</li><li>hi      hardware interrupt
</li><li>si      software interrupt
</li><li>st      stolen by hypervisor
</li><li>PID     process ID
</li><li>USER    user name
</li><li>PR      priority
</li><li>NI      nice value
</li><li>VIRT    virtual memory size (KiB)
</li><li>RES     resident memory size (KiB)
</li><li>SHR     shared memory size (KiB)
</li></ul>

<hr>
</div>
</div>
<div class="chapter-level-extent" id="Kernel">
<div class="nav-panel">
<p>
Next: <a href="#Blog" accesskey="n" rel="next">Blog</a>, Previous: <a href="#System" accesskey="p" rel="prev">System Management</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Kernel-1"><span>4 Kernel<a class="copiable-link" href="#Kernel-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#Building-the-Kernel" accesskey="1">Building the Kernel</a></li>
<li><a href="#Kernel-Modules" accesskey="2">Kernel Modules</a></li>
<li><a href="#mac80211" accesskey="3">mac80211</a></li>
<li><a href="#ath9k_005fhtc-driver" accesskey="4">ath9k_htc driver</a></li>
</ul>
<div class="section-level-extent" id="Building-the-Kernel">
<h3 class="section"><span>4.1 Building the Kernel<a class="copiable-link" href="#Building-the-Kernel"> &para;</a></span></h3>

<p>This is a brief introduction about build a customized linux kernel.
The compiling process has been successfully run on the distribution of Ubuntu 20.04 (Focal Fossa), and the release of the kernel is &quot;linux-5.8.7&quot;.
</p>
<p>The Linux kernel can be download from the <a class="url" href="https://www.kernel.org/">website</a>.
The downloaded files are under the &quot;linux-5.8.7&quot; directory.
</p>
<ul class="mini-toc">
<li><a href="#Prerequisites" accesskey="1">Prerequisites</a></li>
<li><a href="#Build-and-install-the-linux-kernel" accesskey="2">Build and install the linux kernel</a></li>
<li><a href="#Remove-Kernel" accesskey="3">Remove Kernel</a></li>
</ul>
<div class="subsection-level-extent" id="Prerequisites">
<h4 class="subsection"><span>4.1.1 Prerequisites<a class="copiable-link" href="#Prerequisites"> &para;</a></span></h4>

<p>There are some packets that are necessary to compile the kernel. 
It is hard to obtain all the packets manually.
Fortunately, we can get the information from both the <a class="url" href="https://www.kernel.org/doc/html/latest/kbuild/kbuild.html">Linux kernel documentations</a> and the Ubuntu <a class="url" href="https://wiki.ubuntu.com/Kernel/BuildYourOwnKernel">BuildYourOwnKernel Wiki</a>.
Run the following command
</p>
<div class="example">
<pre class="example-preformatted">sudo apt-get build-dep linux linux-image-$(uname -r)

sudo apt-get install libncurses-dev flex bison openssl libssl-dev \
dkms libelf-dev libudev-dev libpci-dev libiberty-dev autoconf
</pre></div>

<p>It is worth to note that directly following <a class="url" href="https://wiki.ubuntu.com/Kernel/BuildYourOwnKernel">BuildYourOwnKernel Wiki</a> has some problems.
When run the command
</p>
<div class="example">
<pre class="example-preformatted">sudo apt-get build-dep linux linux-image-$(uname -r)
sudo apt-get build-dep linux linux-image-$(uname -r)
</pre></div>

<p>it reports an error as follows
</p>
<div class="example">
<pre class="example-preformatted">E: You must put some 'deb-src' URIs in your sources.list
</pre></div>

<p>Please add the contents
</p>
<div class="example">
<pre class="example-preformatted">deb-src http://cn.archive.ubuntu.com/ubuntu/ focal-updates main restricted
deb-src http://cn.archive.ubuntu.com/ubuntu/ focal-updates main restricted
</pre></div>

<p>Then uncomment all commands with &quot;deb-src&quot; in the <code class="code">/etc/apt/sources.list</code> file, and run <code class="code">sudo apt update</code>. 
The error is fixed. 
</p>
</div>
<div class="subsection-level-extent" id="Build-and-install-the-linux-kernel">
<h4 class="subsection"><span>4.1.2 Build and install the linux kernel<a class="copiable-link" href="#Build-and-install-the-linux-kernel"> &para;</a></span></h4>

<p>After installing the prerequisites, the building process is simple enough.
The linux kernel has built-in Makefiles.
In specific, the first process is to config some modules of the kernel. 
Since Linux kernel supports hundreds of modules, it is hard to config them one-by-one.
In stead,  run <code class="code">make oldconfig</code> to config our the kernel.
This command tell the compiler that use the configuration for the new kernel the same as the configuration for the current kernel.
All the new features of the new kernel will be set as the default value, so type &quot;enter&quot; for all these options is enough.
</p>
<p>Note: 
The new kernel has been successfully compiled by following these steps. 
The installed kernel has shown in the grub. However, the OS cannot load by the grub. 
It blocked and shows &quot;loading initial ramdisk&quot;. 
The OS cannot load with the newest kernel, while it can load with an older version. 
This problem may be caused by a kernel bug for Intel devices.
The details can be found in <a class="url" href="https://askubuntu.com/questions/1374282/stuck-on-loading-initial-ramdisk-after-kernel-upgrade">this page</a>.
Otherwise, building the kernel in the <a class="url" href="https://wiki.ubuntu.com/Kernel/BuildYourOwnKernel">Ubuntu way</a> can fix this problem.
</p>
<p>However, during the building process, if the error occurs with <code class="code">llvm-strip:not found</code>.
This message is due to the command <code class="code">llvm-strip</code> does not exist in <code class="code">/usr/bin/</code> directory.
On the other hand, in the directory we can find a command named as <code class="code">llvm-strip-10</code>.
To fix this, we can create a symbolic link (i.e., soft link) with
</p>
<p><code class="code">sudo ln -s /usr/bin/llvm-strip-10 /usr/bin/llvm-strip</code>
</p>
<p>The command will build the kernel with all the chosen modules, so it will take some hours to complete the compiling.
</p>
<p>After the compile complete, the following command will install the kernel
</p>
<div class="example">
<pre class="example-preformatted">sudo make install
sudo make modules_install
</pre></div>


<p>The final step is to update grub, so the new kernel can be found when reboot the system.
</p><div class="example">
<pre class="example-preformatted">sudo update-grub
sudo grub-install
</pre></div>

</div>
<div class="subsection-level-extent" id="Remove-Kernel">
<h4 class="subsection"><span>4.1.3 Remove Kernel<a class="copiable-link" href="#Remove-Kernel"> &para;</a></span></h4>

<p>The built kernel contains the following files:
</p>
<div class="example">
<pre class="example-preformatted">/boot/vmlinuz*KERNEL-VERSION*
/boot/initrd*KERNEL-VERSION*
/boot/System-map*KERNEL-VERSION*
/boot/config-*KERNEL-VERSION*
/lib/modules/*KERNEL-VERSION*/
/var/lib/initramfs-tools/*KERNEL-VERSION*/
</pre></div>

<p>It can be manually removed by <code class="code">sudo rm -rf &lt;kernel_files&gt;</code> command.
</p>
</div>
</div>
<div class="section-level-extent" id="Kernel-Modules">
<h3 class="section"><span>4.2 Kernel Modules<a class="copiable-link" href="#Kernel-Modules"> &para;</a></span></h3>

<p>Linux kernel composes of hundreds of modules.
The user can compile and load modules according to the requirement.
Additionally, independently compiling the module will save lots of time because compile the whole kernel usually needs three or four hours.
</p>
<ul class="mini-toc">
<li><a href="#Prerequisites-1" accesskey="1">Prerequisites</a></li>
<li><a href="#Build-the-Modules" accesskey="2">Build the Modules</a></li>
<li><a href="#Command-about-Module" accesskey="3">Command about Module</a></li>
</ul>
<div class="subsection-level-extent" id="Prerequisites-1">
<h4 class="subsection"><span>4.2.1 Prerequisites<a class="copiable-link" href="#Prerequisites-1"> &para;</a></span></h4>

<p>There are some packets that are necessary to compile the kernel. 
All these packets can be get from apt. 
Please follow the <a class="url" href="https://wiki.ubuntu.com/Kernel/BuildYourOwnKernel">Ubuntu wiki</a> (if use Ubuntu), and run the commands.
</p>
<p>Specifically, first open the &quot;/etc/apt/source.list&quot; with <code class="code">sudo</code> and uncomment commands with &quot;deb-src&quot; in this file.
After saving the file, run <code class="code">sudo apt update</code> to update the packet list.
Then, run the following command to install all the dependents.
</p>
<div class="example">
<pre class="example-preformatted">sudo apt-get build-dep linux linux-image-$(uname -r)

sudo apt-get install libncurses-dev flex bison openssl libssl-dev \
dkms libelf-dev libudev-dev libpci-dev libiberty-dev autoconf
</pre></div>

<p>The next step is to download the kernel source code. 
One can download the newest kernel from <a class="url" href="https://www.kernel.org/">the official website</a>.
However, in this website is difficult to download the old version. 
</p>
<p>Instead, the aternative method is to download the source code by using &quot;apt&quot;.
</p>
<p><code class="code">sudo apt install linux-source-5.4.0</code>
</p>
<p>Then the corresponding version of the source code can be downloaded. 
The kernel version of Ubuntu 20.04 is 5.4.0.
The  of this source code can be found in &quot;/usr/src/linux-source-5.4.0&quot;.
The source code is a compressed file, and run <code class="code">sudo tar jvxf linux-source-5.4.0.tar.bz2</code> to uncompress it.
</p>
</div>
<div class="subsection-level-extent" id="Build-the-Modules">
<h4 class="subsection"><span>4.2.2 Build the Modules<a class="copiable-link" href="#Build-the-Modules"> &para;</a></span></h4>

<p>Build a module or modules is very simple.
Linux kernel uses &quot;Kbuild&quot; to compile the kernel. 
&quot;Kbuild&quot; is at the root directory of the source code (i.e., at ./linux-source-5.4.0/ in my case).
Build the module needs to at the ./linux-source-5.4.0/ directory.
</p>
<p>As an example, we use the compilinig process of &quot;iwlwifi&quot; module, which is the wireless Linux driver of Intel wireless network card.
</p>
<p>The source code of this module is at <code class="code">/usr/src/linux-source-5.4.0/linux-source-5.4.0/drivers/net/wireless/intel/iwlwifi/</code> in this case. 
</p>
<div class="example">
<pre class="example-preformatted">make oldconfig &amp;&amp; make prepare
make # This command is to compile the kernel
     # which is the prerequisit of the module compilation
sudo make M=./drivers/net/wireless/intel/iwlwifi modules
</pre></div>

<p>After the compiling process is complete, a file named as &quot;iwlwifi.ko&quot; at he iwlwifi directory can be found.
</p>
<p>To install it, use the following command
</p>
<div class="example">
<pre class="example-preformatted">cd ./drivers/net/wireless/intel/iwlwifi
insmod iwlwifi.ko
</pre></div>

<p><code class="code">insmod</code> means &quot;insert module&quot;.
This is a command to install Linux kernel module.
</p>
<p>If the iwlwifi module has been installed in the kernel, the old modules can be removed from the kernel with <code class="code">sudo modprobe -r iwlwifi</code>.
Then, run the <code class="code">insmod</code> command to install the compiled module.
</p>
</div>
<div class="subsection-level-extent" id="Command-about-Module">
<h4 class="subsection"><span>4.2.3 Command about Module<a class="copiable-link" href="#Command-about-Module"> &para;</a></span></h4>

<p>All the usage are an example of the *iwlwifi* module.
</p>
<ul class="mini-toc">
<li><a href="#lsmod" accesskey="1">lsmod</a></li>
<li><a href="#modinfo" accesskey="2">modinfo</a></li>
<li><a href="#modprobe" accesskey="3">modprobe</a></li>
<li><a href="#insmod" accesskey="4">insmod</a></li>
</ul>
<div class="subsubsection-level-extent" id="lsmod">
<h4 class="subsubsection"><span>4.2.3.1 lsmod<a class="copiable-link" href="#lsmod"> &para;</a></span></h4>

<p><code class="code">lsmod</code> is a command to list all installed module in the kernel.
It contains some information such as name, dependencies, etc.
</p>
<p>Usage: <code class="code">lsmod</code>
</p>
</div>
<div class="subsubsection-level-extent" id="modinfo">
<h4 class="subsubsection"><span>4.2.3.2 modinfo<a class="copiable-link" href="#modinfo"> &para;</a></span></h4>

<p><code class="code">modinfo</code> can display details about a specific module.
It can display the information of either a installed module or a compiled module.
</p>
<p>Usage: <code class="code">modinfo iwlwifi</code>
</p>
<p>This command display the information of the installed module &quot;iwlwifi&quot;, not the compiled module.
</p>
<p>Usage: <code class="code">modinfo iwlwifi.ko</code>
</p>
<p>This command display the information of the compiled module.
</p>
</div>
<div class="subsubsection-level-extent" id="modprobe">
<h4 class="subsubsection"><span>4.2.3.3 modprobe<a class="copiable-link" href="#modprobe"> &para;</a></span></h4>

<p><code class="code">modprobe</code> is usually used to install or remove a module.
</p>
<p>Usage: <code class="code">sudo modprobe -r iwlwifi</code>
</p>
<p>Remove the iwlwifi module.
</p>
<p>Usage: <code class="code">sudo modprobe iwlwifi</code>
</p>
<p>Install the iwlwifi module.
</p>
</div>
<div class="subsubsection-level-extent" id="insmod">
<h4 class="subsubsection"><span>4.2.3.4 insmod<a class="copiable-link" href="#insmod"> &para;</a></span></h4>

<p><code class="code">insmod</code> can install a customized module.
If the module with the same name has been installed, <code class="code">sudo modprobe -r iwlwifi</code> is needed to remove the pre-installed module.
</p>
<p>Usage: <code class="code">insmod iwlwifi.ko</code>
</p>
</div>
</div>
</div>
<div class="section-level-extent" id="mac80211">
<h3 class="section"><span>4.3 mac80211<a class="copiable-link" href="#mac80211"> &para;</a></span></h3>

<ul class="mini-toc">
<li><a href="#Rate-Control" accesskey="1">Rate Control</a></li>
</ul>
<div class="subsection-level-extent" id="Rate-Control">
<h4 class="subsection"><span>4.3.1 Rate Control<a class="copiable-link" href="#Rate-Control"> &para;</a></span></h4>

<p>Rate control (or rate adaptation) is an important algorithm for wireless devices to select the optimal bit rate under different wireless channel conditions.
In mac80211 subsystem in Linux kernel, rate control is part of the subsystem, and it can be self-designed by each wireless driver.
For example, ath9k driver uses the default rate control (i.e., <code class="code">https://wireless.wiki.kernel.org/en/developers/documentation/mac80211/ratecontrol/minstrel, minstrel</code>), while iwlwifi uses a custom rate control named <code class="code">https://wiki.gentoo.org/wiki/Iwlwifi, &quot;iwl-agn-rs&quot;</code>.
</p>
<p>mac80211 provides a struct <code class="code">https://docs.huihoo.com/doxygen/linux/kernel/3.7/structrate__control__ops.html, &quot;rate_control_ops&quot;</code> with multiple callbacks.
To implement a new rate control algorithm, someone must define these callbacks in <code class="code">rate_control_ops</code>.
For example, minstrel includes two types of algorithm, one is in the file <code class="code">rc80211_minstrel.c</code> (mac80211_minstrel) and the other is in the file <code class="code">rc80211_minstrel_ht.c</code> (mac80211_minstrel_ht).
</p>
<p>For iwlwifi driver, <code class="code">rate_control_ops</code> is defined in <code class="code">dvm/mac80211.c</code> (rs_ops) and <code class="code">mvm.mac80211.c</code> (rs_mvm_ops_drv), depend on different types of drivers.
</p>
<p><code class="code">rate.c</code> defines all rate control functions for different drivers.
Ideally, the developer does not need to change the function in <code class="code">rate.c</code>.
</p>
<p>Two basic functions in this file is <code class="code">ieee80211_rate_control_register</code> and <code class="code">ieee80211_rate_control_unregister</code>.
The driver loads different rate control algorithms by calling the two functions.
</p>
</div>
</div>
<div class="section-level-extent" id="ath9k_005fhtc-driver">
<h3 class="section"><span>4.4 ath9k_htc driver<a class="copiable-link" href="#ath9k_005fhtc-driver"> &para;</a></span></h3>

<p><a class="url" href="https://wireless.wiki.kernel.org/en/users/drivers/ath9k_htcl">ath9k_htc</a> driver is a wireless driver for IEEE 802.11n devices with USB port.
It can support AR9271 USB devices.
Atheros provides an open source version of the firmware, i.e., <a class="url" href="https://github.com/qca/open-ath9k-htc-firmware">open-ath9k-htc-firmware</a>.
</p>
<p>This document is a simple analysis about the RX pipeline of ath9k_htc.
</p>
<p>ath9k_htc is based on other ath drivers, you can find the drivers and all relations with
</p>
<div class="example">
<pre class="example-preformatted">    $lsmod | grep ath
    ath9k_htc              77824  0
    ath9k_common           36864  1 ath9k_htc
    ath9k_hw              483328  2 ath9k_htc,ath9k_common
    ath                    36864  3 ath9k_htc,ath9k_common,ath9k_hw
    mac80211             1024000  2 ath9k_htc,iwlmvm
    cfg80211              888832  6 ath9k_htc,ath9k_common,iwlmvm,ath,iwlwifi,mac80211
</pre></div>

<p>The description of all drivers can found in <a class="url" href="http://linuxwireless.sipsolutions.net/en/users/Drivers/Atheros/__v22.html">Atheros Linux wireless drivers</a>.
</p>

<p>In Ubuntu, &quot;apt&quot; can be used to download the Linux kernel source code with the current kernel version  by using
</p>
<p><code class="code">apt source linux-image-unsigned-$(uname -r)</code>
</p>
<p>After changing into the kernel file, the source code of ath9k_htc is in 
</p>    
<p><code class="code">/driver/net/wireless/ath/ath9k/</code>
</p>
<p>If the downloaded driver is mismatched with the Linux kernel version, the &quot;insmod&quot; command will report an error with invalid module format.
</p>
<p>All htc related codes are listed in the following files.
</p>
<div class="example">
<pre class="example-preformatted">    htc_drv_init.c
    htc_drv_main.c
    htc_drv_txrx.c
    htc_drv_beacon.c  
    htc_drv_gpio.c    
    htc_hst.c
    hif_usb.c
    htc_drv_debug.c
</pre></div>

<p>In particular, &quot;htc_drv_main.c&quot; is the entry point of HTC driver with &quot;module_init&quot; and &quot;module_exit&quot;.
Other files related to receive data is &quot;htc_drv_txrx.c&quot;, &quot;htc_hst.c&quot;, and &quot;hif_usb.c&quot;
</p>
<p>AR9271 chips connect to the device with USB port, so it uses USB subsystem in Linux kernel to transmit and receive data.
As a USB device, it uses USB Request Block (URB) to receive data.
</p>
<p>All functions about URB reception are in &quot;hif_usb.c&quot; file.
In specific, the following functions is the main process for the data reception.
</p>
<div class="example">
<pre class="example-preformatted">    hif_usb.c
        |
        |---ath9k_hif_usb_alloc_rx_urbs(struct hif_device_usb *hif_dev)
            |
            |---usb_fill_bulk_urb(urb, hif_dev-&gt;udev,
            |             usb_rcvbulkpipe(hif_dev-&gt;udev,
            |                     USB_WLAN_RX_PIPE),
            |             skb-&gt;data, MAX_RX_BUF_SIZE,
            |             ath9k_hif_usb_rx_cb, rx_buf);
            |
            |---usb_anchor_urb(urb, &amp;hif_dev-&gt;rx_submitted);
            |
            |---ret = usb_submit_urb(urb, GFP_KERNEL);
            |
        |---ath9k_hif_usb_rx_cb(struct urb *urb)
        |---ath9k_hif_usb_rx_stream(struct hif_device_usb *hif_dev, struct sk_buff *skb)

    htc_hst.c
        |
        |---ath9k_htc_rx_msg(struct htc_target *htc_handle, 
        |                       struct sk_buff *skb, 
        |                       u32 len, u8 pipe_id)

    htc_drv_txrx.c
        |
        |---ath9k_htc_rxep(void *drv_priv, struct sk_buff *skb, htc_endpoint_id ep_id)
            |
            |---tasklet_schedule(&amp;priv-&gt;rx_tasklet)
            |---ath9k_rx_tasklet(struct tasklet_struct *t)
</pre></div>

<p>In <code class="code">ath9k_hif_usb_alloc_rx_urbs</code>, it allocates a usb bulk URB for signal reception, the callback function is <code class="code">ath9k_hif_usb_rx_cb</code>. 
It will submit the URB to the USB core and call the callback function.
If you are new to Linux USB, for a detailed description about <a class="url" href="https://manpages.debian.org/testing/linux-manual-4.8/usb_fill_bulk_urb.9.en.html">usb_fill_bulk_urb</a> and <a class="url" href="https://manpages.debian.org/testing/linux-manual-4.9/usb_submit_urb.9">usb_submit_urb</a>, please refer to <a class="url" href="https://www.kernel.org/doc/html/v4.15/driver-api/usb/index.html">Linux USB API</a>.
</p>
<p>In <code class="code">ath9k_hif_usb_rx_cb</code>, it will process skb, if it has new data, the data will pass to <code class="code">ath9k_hif_usb_rx_stream</code>.
After that, it will call itself by resubmitting the URB. 
The resubmit ensure that USB core will repeatedly poll the buffer to receive data.
</p>
<p>In <code class="code">ath9k_hif_usb_rx_stream</code>, it will packetize the data in buffer. Each packet will push into <code class="code">ath9k_htc_rx_msg</code> in <code class="code">htc_hst.c</code> file.
</p>
<p><code class="code">ath9k_htc_rx_msg</code> will handle different types of packets.
For a data packet, it will call <code class="code">endpoint-&gt;ep_callbacks.rx</code>, which is also a callback function. 
The callback handler is defined in <code class="code">htc_drv_txrx.c</code>, which is named as <code class="code">ath9k_htc_rxep</code>.
</p>
<p>Finally, <code class="code">ath9k_htc_rxep</code> will check that whether the buffer is valid, and call <code class="code">tasklet_schedule</code>.
<a class="url" href="http://books.gigatux.nl/mirror/kerneldevelopment/0672327201/ch07lev1sec3.html">Tasklet</a> is an interrupt in Linux Kernel.
In this tasklet, ath9k_htc defines a callback for reception named as <code class="code">ath9k_rx_tasklet</code>, which is the final process of signal reception. 
The data will pass to mac80211 subsystem by calling <a class="url" href="https://elixir.bootlin.com/linux/latest/ident/ieee80211_rx">ieee80211_rx</a>.
</p>
<ul class="mini-toc">
<li><a href="#Customized-ath9k" accesskey="1">Customized ath9k</a></li>
</ul>
<div class="subsection-level-extent" id="Customized-ath9k">
<h4 class="subsection"><span>4.4.1 Customized ath9k<a class="copiable-link" href="#Customized-ath9k"> &para;</a></span></h4>

<p>ath9k is a kernel driver that works as a kernel module for Atheros wireless IEEE802.11n NICs.
Compilation of the kernel module is the prerequisite to investigate the rate adaptation algorithm.
However, the driver (and the kernel module) highly depends on the version of the kernel, so it is difficult to compile and install even a simple driver.
</p>
<p>This subsection introduces a basic and simple method to build it on the newest Ubuntu 22.04.
</p>
<p>First, change to the directory of ath driver, which is in the <code class="code">./drivers/net/wireless/ath/</code> if the working directory is the root of the kernel source code.
Note that ath9k driver is based on the ath module, so we better compile is at the same time.
</p>
<p>In the directory, build the driver for the current kernel with
</p>
<p><code class="code">make -C /lib/modules/`uname -r`/build M=$PWD</code>  
</p>
<p>where <code class="code">$PWD</code> means print work directory.
</p>
<p>Now, the compilation is complete, we can load the modules with 
</p>
<div class="example">
<pre class="example-preformatted">    insmod ath.ko
    insmod ./ath9k_common.ko
    insmod ./ath9k_hw.ko
    insmod ./ath9k.ko
</pre></div>
 
<p>Use <code class="code">sudo modprobe -r &lt;MODULE_NAME&gt;</code> to remove the old versions of them.
</p><hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Blog">
<div class="nav-panel">
<p>
Next: <a href="#Shell" accesskey="n" rel="next">Shell</a>, Previous: <a href="#Kernel" accesskey="p" rel="prev">Kernel</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Blog-1"><span>5 Blog<a class="copiable-link" href="#Blog-1"> &para;</a></span></h2>

<p>This blog is based on <a class="url" href="https://pages.github.com/">Github page</a> and <a class="url" href="https://jekyllrb.com/">jekyll</a>.
</p>
<ul class="mini-toc">
<li><a href="#Installation" accesskey="1">Installation</a></li>
<li><a href="#Jekyll-Themes" accesskey="2">Jekyll Themes</a></li>
<li><a href="#Usage" accesskey="3">Usage</a></li>
<li><a href="#Upgrade" accesskey="4">Upgrade</a></li>
</ul>
<div class="section-level-extent" id="Installation">
<h3 class="section"><span>5.1 Installation<a class="copiable-link" href="#Installation"> &para;</a></span></h3>

<p>It requires Ruby, RubyGems, and bundler.
</p>
<p>The following command can install the prerequisites
</p>
<p><code class="code">sudo apt install ruby-full build-essential zlib1g-dev</code>
</p>
<p>Sometimes gem is hard to access in some regions.
It is recommended to change the source link.
As an example, 
</p>
<p><code class="code">sudo gem source --add &lt;https://mirror.com&gt; --remove https://rubygems.org/</code>
</p>
<p>where <code class="code">&lt;https://mirror.com&gt;</code> is the host of a mirror.
The follow installs jekyll and bundler
</p>
<p><code class="code">sudo gem install jekyll bundler</code>
</p>
</div>
<div class="section-level-extent" id="Jekyll-Themes">
<h3 class="section"><span>5.2 Jekyll Themes<a class="copiable-link" href="#Jekyll-Themes"> &para;</a></span></h3>

<p>The blog is based on [mediator](https://jekyllthemes.io/theme/mediator) theme.
Download the theme and copy it into my own git directory by
</p>
<p><code class="code">git clone https://github.com/dirkfabisch/mediator</code>
</p>
</div>
<div class="section-level-extent" id="Usage">
<h3 class="section"><span>5.3 Usage<a class="copiable-link" href="#Usage"> &para;</a></span></h3>

<p>The blog can be used from source with &lsquo;bundle&lsquo;
</p>
<p><code class="code">bundle exec jekyll server</code>
</p>
</div>
<div class="section-level-extent" id="Upgrade">
<h3 class="section"><span>5.4 Upgrade<a class="copiable-link" href="#Upgrade"> &para;</a></span></h3>

<p>Bundler and Jekyll requires the correct version of Ruby.
If Ruby is updated within the system upgrade, bundler and Jekyll both need to reinstall from gem.
For example, when Ubuntu 22.04 is upgraded from Ubuntu 20.04, Ruby 3.0 would be installed, but bundler and Jekyll both requires Ruby 2.7.
So the two programs would not processing correctly anymore.
</p>
<p>To fix this problem, the direct approach is to reinstall bundle with gem.
</p>
<p><code class="code">sudo gem install bundler</code>
</p>
<p>Then, bundle can install all required packages by &lsquo;bundle install&lsquo; except *webrick* because webrick is no longer in the standard library of bundle.
However, I have a network issue when run &lsquo;bundle add webrick&lsquo;.
It shows &quot;Could not reach host index.rubygems.org. Check your network connection and try again.&quot;
The straightforward method is to set a mirror by
</p>
<p><code class="code">bundle config mirror.https://rubygems.org &lt;https://mirror.com&gt;</code>
</p>
<p>where <code class="code">&lt;https://mirror.com&gt;</code> is the host of a mirror.
However, it still does not work for me, while the mirror still can be reached by ping, curl, and the browser with ipv4.
So the problem is strange, but I fix it with root command.
</p>
<p><code class="code">sudo bundle config mirror.https://rubygems.org &lt;https://mirror.com&gt;</code>
<code class="code">sudo bundle install</code>
<code class="code">sudo bundle add webrick</code>
</p>
<p>The ipv6 is also cloased because it seems that bundle only supports ipv4, but it is not sure if this process works.
</p><hr>
</div>
</div>
<div class="chapter-level-extent" id="Shell">
<div class="nav-panel">
<p>
Next: <a href="#Editor" accesskey="n" rel="next">Editor</a>, Previous: <a href="#Blog" accesskey="p" rel="prev">Blog</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Shell-1"><span>6 Shell<a class="copiable-link" href="#Shell-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#Terminal-emulator" accesskey="1">Terminal emulator</a></li>
<li><a href="#Swap-keys" accesskey="2">Swap keys</a></li>
<li><a href="#Bash" accesskey="3">Bash</a></li>
</ul>
<div class="section-level-extent" id="Terminal-emulator">
<h3 class="section"><span>6.1 Terminal emulator<a class="copiable-link" href="#Terminal-emulator"> &para;</a></span></h3>

<p>Terminal emulator is the prerequisite of shell.
An open-source terminal emulator is terminator.
Install it with
</p>
<p><code class="code">sudo apt install terminator</code>
</p>
<p>The terminal emulator provides color and font support for shell.
For example, the <a class="url" href="https://github.com/agnoster/agnoster-zsh-theme">agnoster theme</a> of zsh requires the powerline font.
To install it, run
</p>
<p><code class="code">sudo apt install fonts-powerline</code>
</p>
<p>and then set the fonts in the terminator.
</p>
</div>
<div class="section-level-extent" id="Swap-keys">
<h3 class="section"><span>6.2 Swap keys<a class="copiable-link" href="#Swap-keys"> &para;</a></span></h3>

<p>Usually, if someone wants to swap Caplock and left Ctrl since the latter is more useful, some desktop provides an GUI tool such as gnome-tweak in GNOME or the setting in KDE that support this function.
For the desktops that do not have an GUI tool, a shell method is to use xmodmap and the GUI helper xkeycaps.
After change the keys in xkeycaps, write out the configuration file of xmodmap in the HOME diretory, and add the follows in the shell
</p>
<p><code class="code">xmodmap ~/.xmodmap-`uname -n`</code>
</p>
<p>xmodmap will trigger the key swap when open a terminal.
</p>
</div>
<div class="section-level-extent" id="Bash">
<h3 class="section"><span>6.3 Bash<a class="copiable-link" href="#Bash"> &para;</a></span></h3>

<p>Bash has two style interface: emacs style and vi style.
Emacs style is the default style.
Vi style can type &lt;Esc&gt; to exit insert mode and use vim keybindings.
The follows are the keymappings in for its emacs style.
</p>
<div class="example">
<pre class="example-preformatted">    CTRL+a/e    # Move to begin/End of the line
    CTRL+b/f    # Backward/forward
    CTRL+c      # Halt
    CTRL+d      # Logout when no editing command
                # Display the completion for the commmand
    CTRL+g      # Abort the editing command
    CTRL+h      # Delete the character before cursor
    CTRL+j/m    # &lt;RETURN&gt;
    CTRL+k/w    # Delete to the end/begin of the line
    CTRL+l      # Clears the terminal except the current line
    CTRL+n/p    # &lt;DOWN&gt;/&lt;UP&gt;
    CTRL+o      # &lt;RETURN&gt;, then display next line in the history

    CTRL+s/q    # Suspend/Resume shell output
    CTRL+r      # Search backward
    CTRL+t      # Transpose two characters
    CTRL+u      # Delete the line
    CTRL+v      # Enable to insert control strings
    CTRL+y      # Yank (for CTRL+k/u/w)
    CTRL+z      # Stop the current command, resume with 'fg' in the foreground

    CTRL+x (    # Recording a keyboard macro
    CTRL+x )    # Stop recording
    CTRL+x e    # Recall the record

    CTRL+x CTRL+e   # Invoke text editor in $EDITOR 
                    # Recommandation: export EDITOR=vim
                    # In vim, you can type the command
                    # Type 'ZZ' in normal mode to input multi-line commands for bash

    CTRL+S      # Search forword

    ALT+b/f     # Backward/Forward one word
    ALT+c       # Upper character
    ALT+d       # Delete word
    ALT+h       # 'run-help' program 
    ALT+l/u     # Upper, to the end/begin of the line
    ALT+n/p     # Search history to match the edited command
    ALT+r       # Revert changes of the command from the history
    ALT+t       # Transpose two words
    ALT+.       # Paste last word from the last command
    ALT+?       # List completions

    !!          # Repeat the last command
    !&lt;n&gt;        # Refer to command line 'n'
    !&lt;string&gt;   # Refer to command starting with 'string'
</pre></div>


<p>## File
</p>
<p>touch &lt;file&gt;        # Update timestamp
                        # Make a new file
    mktemp -t &lt;file&gt;    # Make a temp file in /tmp/ 
    cat &lt;file&gt;          # Display &lt;file&gt;
    nl &lt;file&gt;           # Number of lines 
    wc &lt;file&gt;           # Word count
    more/less &lt;file&gt;    # Display a file and type q to quit
    head/tail &lt;file&gt;    # Output the first/last lines of file 
    diff                # Compare two files
    sort &lt;file&gt;         # Sort the file line by line
    rev &lt;file&gt;          # Reverse strings in file line by line
    grep &lt;pat&gt; &lt;file&gt;   # Find for the string in the &lt;file&gt;
    sed                 # Stream editor
</p>
<p>ln -s &lt;file&gt; &lt;link&gt; # Symbolic link to &lt;file&gt;
    readlink &lt;link&gt;     # Display the file name of the symbolic link 
</p>
<p>## Disk
</p>
<p>df                  # Disk free
    df -h               # Echo the result with human-readable output
    du                  # Disk used
    du -h -d 1 . 2&amp;&gt; /dev/null | grep &quot;G\s&quot;
                        # Echo the size of directories and files of the 
                        # current folder. Ignore errors. Grep a space 
                        # after &rsquo;G&rsquo;. Useful command to show the large 
                        # directories and files
</p>
<ul class="mini-toc">
<li><a href="#Process-and-Job" accesskey="1">Process and Job</a></li>
<li><a href="#Variable" accesskey="2">Variable</a></li>
<li><a href="#IF-Condition" accesskey="3">IF Condition</a></li>
<li><a href="#Input_002fOutput-Redirector" accesskey="4">Input/Output Redirector</a></li>
<li><a href="#Debug" accesskey="5">Debug</a></li>
<li><a href="#eval" accesskey="6">eval</a></li>
<li><a href="#Color" accesskey="7">Color</a></li>
</ul>
<div class="subsection-level-extent" id="Process-and-Job">
<h4 class="subsection"><span>6.3.1 Process and Job<a class="copiable-link" href="#Process-and-Job"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    jobs                # Builtin: List jobs
    ps                  # List processes in snapshot
    top                 # Real-time list processes
    kill/killall        # Builtin: Kill process with PID/name
    bg                  # Builtin: List background jobs
    fg                  # Builtin: Bring the background job to foreground
    time &lt;command&gt;      # Builtin: Execution time
    wait                # Builtin: Wait all background jobs to finish
    sleep &lt;num&gt;         # wait &lt;num&gt; seconds before continuing
    yes                 # Always yes
</pre></div>


</div>
<div class="subsection-level-extent" id="Variable">
<h4 class="subsection"><span>6.3.2 Variable<a class="copiable-link" href="#Variable"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    var=value           # Variables, NO &lt;SPACE&gt;
    export VAR=value    # Environment variable to child, NO &lt;SPACE&gt;
    ${#var}             # Length of var

    list=(a b c)        # List
    ${list[@]}          # All elements in list


    read &lt;var&gt;          # Read from input and assign it to &lt;var&gt;
    let &lt;var&gt; = &lt;expr&gt;  # let a result of &lt;expr&gt; 
    declare &lt;var&gt;       # Declare variable and its attribute
</pre></div>

<table class="multitable">
<thead><tr><th width="20%"></th><th width="20%">Parameter Set and Not Null</th><th width="20%">Parameter Set but Null</th><th width="20%">Parameter Not Set</th></tr></thead>
<tbody><tr><td width="20%">${parameter:-word}</td><td width="20%">substitute parameter</td><td width="20%">substitute word</td><td width="20%">substitute word</td></tr>
<tr><td width="20%">${parameter:=word}</td><td width="20%">substitute parameter</td><td width="20%">assign word</td><td width="20%">assign word</td></tr>
<tr><td width="20%">${parameter:?word}</td><td width="20%">substitute parameter</td><td width="20%">error, exit</td><td width="20%">error, exit</td></tr>
<tr><td width="20%">${parameter:+word}</td><td width="20%">substitute parameter</td><td width="20%">substitute null</td><td width="20%">substitute null</td></tr>
<tr><td width="20%">${parameter-word}</td><td width="20%">substitute parameter</td><td width="20%">substitute null</td><td width="20%">substitute word</td></tr>
<tr><td width="20%">${parameter=word}</td><td width="20%">substitute parameter</td><td width="20%">substitute null</td><td width="20%">assign word</td></tr>
<tr><td width="20%">${parameter?word}</td><td width="20%">substitute word</td><td width="20%">substitute null</td><td width="20%">error, exit</td></tr>
<tr><td width="20%">${parameter+word}</td><td width="20%">substitute word</td><td width="20%">substitute word</td><td width="20%">substitute null</td></tr>
</tbody>
</table>

<div class="example">
<pre class="example-preformatted">    ${variable#pattern}     # Remove Smallest Prefix Pattern
    ${variable##pattern}    # Remove Largest Prefix Pattern
    ${variable%pattern}     # Remove Smallest Suffix Pattern    
    ${variable%%pattern}    # Remove Largest Suffix Pattern     

    $0      # The program
    $1      # The first parameter
    $2      # The second parameter
    $#      # The number of parameters
    $&nbsp;     # All parameters in a list
</pre></div>

</div>
<div class="subsection-level-extent" id="IF-Condition">
<h4 class="subsection"><span>6.3.3 IF Condition<a class="copiable-link" href="#IF-Condition"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    test expression
    [ expression ]
    [[ expression ]]
</pre></div>

<ul class="mini-toc">
<li><a href="#String" accesskey="1">String</a></li>
<li><a href="#File" accesskey="2">File</a></li>
<li><a href="#Numbers" accesskey="3">Numbers</a></li>
</ul>
<div class="subsubsection-level-extent" id="String">
<h4 class="subsubsection"><span>6.3.3.1 String<a class="copiable-link" href="#String"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    str1 == str2    # Match
    str1 != str2    # Not match
    str1 &lt; str2     # Less
    str1 &gt; str2     # Greater
    -z str1         # Null
    -n str1         # Not null
</pre></div>

</div>
<div class="subsubsection-level-extent" id="File">
<h4 class="subsubsection"><span>6.3.3.2 File<a class="copiable-link" href="#File"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    -a file         # File
    -b file         # Block file
    -c file         # character file
    -d file         # Directory
    -e file         # File
    -f file         # Regular file
    -r file         # Read
    -s file         # Not empty
    -w file         # Write
    -x file         # Execute
    -N file         # File was modified
    -O file         # File belongs to user
    -G file         # File belongs to user group
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Numbers">
<h4 class="subsubsection"><span>6.3.3.3 Numbers<a class="copiable-link" href="#Numbers"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    -lt         # Less than
    -le         # Less than or equal
    -eq         # Equal
    -ge         # Greater than or equal
    -gt         # Greater than
    -ne         # Not equal
</pre></div>


</div>
</div>
<div class="subsection-level-extent" id="Input_002fOutput-Redirector">
<h4 class="subsection"><span>6.3.4 Input/Output Redirector<a class="copiable-link" href="#Input_002fOutput-Redirector"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">    |           # Pipe
    &lt; file      # Redirect input
    &gt; file      # Redirect output
    &gt;&gt; file     # Redirect output and append to a file
    &lt;&gt; file     # uses file as both standard input and standard output
    2&gt;&amp;1        # Redirect error output to standard output
    n&lt;&amp;m        # Redirect input file n to m
    n&gt;&amp;m        # Redirect output file n to m 
    
    cat &lt;&lt; EOF # Here document
        Text
    EOF

    tee &lt;file&gt;  # output input to both terminal and a file 
</pre></div>

</div>
<div class="subsection-level-extent" id="Debug">
<h4 class="subsection"><span>6.3.5 Debug<a class="copiable-link" href="#Debug"> &para;</a></span></h4>

<p>Run the script
</p><div class="example">
<pre class="example-preformatted">    bash -n scriptname  # Check errors without running
    bash -v scriptname  # Print shell input lines as they are read.
    bash -x scriptname  # Print commands and their arguments as they are executed.
</pre></div>

<p>Set options in script
</p>
<div class="example">
<pre class="example-preformatted">    set -o noexec       # Check errors without running
    set -o verbose      # Print shell input lines as they are read.
    set -o xtrace       # Print commands and their arguments as they are executed.
</pre></div>

</div>
<div class="subsection-level-extent" id="eval">
<h4 class="subsection"><span>6.3.6 eval<a class="copiable-link" href="#eval"> &para;</a></span></h4>

<p>With eval, bash can print the value of a variable as well as its name
In this case, the value of BLACK is a string to control the string&rsquo;s color
The value of COLOR is the string &quot;BLACK&quot;
</p><div class="example">
<pre class="example-preformatted">BLACK='\e[30m'
COLOR=BLACK
eval echo -e '$'{${COLOR}}${COLOR}
</pre></div>

</div>
<div class="subsection-level-extent" id="Color">
<h4 class="subsection"><span>6.3.7 Color<a class="copiable-link" href="#Color"> &para;</a></span></h4>
<div class="example">
<pre class="example-preformatted">    BLACK='\e[30m'
    RED='\e[31m'
    GREEN='\e[32m' 
    YELLOW='\e[33m'
    BLUE='\e[34m'
    PURPLE='\e[35m'
    CYAN='\e[36m'
    WHITE='\e[37m'
    LBLACK='\e[90m'
    LRED='\e[91m'
    LGREEN='\e[92m'
    LYELLOW='\e[93m'
    LBLUE='\e[94m'
    LPURPLE='\e[95m'
    LCYAN='\e[96m'
    LGREY='\e[97m'

    echo -en &quot;${RED}RED&quot;
</pre></div>
<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Editor">
<div class="nav-panel">
<p>
Next: <a href="#Version-Control" accesskey="n" rel="next">Version Control</a>, Previous: <a href="#Shell" accesskey="p" rel="prev">Shell</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Editor-1"><span>7 Editor<a class="copiable-link" href="#Editor-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#Vim" accesskey="1">Vim</a></li>
<li><a href="#Micro-Editor" accesskey="2">Micro Editor</a></li>
</ul>
<div class="section-level-extent" id="Vim">
<h3 class="section"><span>7.1 Vim<a class="copiable-link" href="#Vim"> &para;</a></span></h3>

<p>Vim has six modes: normal, insert, operator-pending, visual, select, and command-line modes.
All the keys in the keyboard have been used as a command in these mode.
</p>
<ul class="mini-toc">
<li><a href="#Normal_002fVisual-Mode" accesskey="1">Normal/Visual Mode</a></li>
<li><a href="#Insert-Mode" accesskey="2">Insert Mode</a></li>
<li><a href="#Command_002dLine-Mode" accesskey="3">Command-Line Mode</a></li>
<li><a href="#Test-Vim-Script" accesskey="4">Test Vim Script</a></li>
<li><a href="#Vim-Distribution" accesskey="5">Vim Distribution</a></li>
</ul>
<div class="subsection-level-extent" id="Normal_002fVisual-Mode">
<h4 class="subsection"><span>7.1.1 Normal/Visual Mode<a class="copiable-link" href="#Normal_002fVisual-Mode"> &para;</a></span></h4>

<p>Most keymappings both can work in normal and visual mode with slightly difference.
</p>
<ul class="mini-toc">
<li><a href="#Movement" accesskey="1">Movement</a></li>
<li><a href="#Mark" accesskey="2">Mark</a></li>
<li><a href="#Edit-and-Register" accesskey="3">Edit and Register</a></li>
<li><a href="#Text-Object" accesskey="4">Text Object</a></li>
<li><a href="#Keymapings-start-with-_0027Z_0027-and-_0027z_0027" accesskey="5">Keymapings start with &rsquo;Z&rsquo; and &rsquo;z&rsquo;</a></li>
<li><a href="#Keymappings-start-with-_0027g_0027" accesskey="6">Keymappings start with &rsquo;g&rsquo;</a></li>
<li><a href="#Window" accesskey="7">Window</a></li>
<li><a href="#Filter" accesskey="8">Filter</a></li>
</ul>
<div class="subsubsection-level-extent" id="Movement">
<h4 class="subsubsection"><span>7.1.1.1 Movement<a class="copiable-link" href="#Movement"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">h/j/k/l     Character-level movement: left/down/up/right
F/f&lt;char&gt;   Character-level movement: Find the &lt;char&gt; on left/right
T/t&lt;char&gt;   Character-level movement: Till (Find) before/after &lt;char&gt; on left/right
;           Repeat: F/f/T/t
,           Repeat: F/f/T/t in opposite direction
w/W         Word-level movement: forward to the begin of the word/WORD 
e/E         Word-level movement: forward to the end of the word/WORD 
b/B         Word-level movement: backward to the begin of the word/WORD 
0/$         Line-level movement: Begin/End of the line
^           Line-level movement: The first non-blank character of the line
&lt;count&gt;|    Line-level movement: The &lt;count&gt; column in this line
+/-         Line-level movement: Downward/Upward
&lt;count&gt;_    Line-level movement: Downward &lt;count&gt;-1 lines, on the first non-blank character
H/M/L       Window-level movement: Top/Middle/Bottom of the window
G           Document-level movement: End of the document
'           Document-level movement: Jump to the line of the mark
`           Document-level movement: Jump to the mark
K           Run an external predefined program with word (i.e., !&lt;Program&gt; &lt;word&gt;)
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Mark">
<h4 class="subsubsection"><span>7.1.1.2 Mark<a class="copiable-link" href="#Mark"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">m&lt;A-Z&gt;              Set global marks
m&lt;a-z&gt;              Set local marks
'&lt;A-Za-z0-9&gt;        Document-level movement: Jump to the mark
`&lt;A-Za-z0-9&gt;        Document-level movement: Jump to the mark
:mark &lt;A-Za-z&gt;      Set global/local marks
:marks              List all marks
:delmarks &lt;A-Za-z&gt;  Delete mark
:delmarks!          Delete all marks
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Edit-and-Register">
<h4 class="subsubsection"><span>7.1.1.3 Edit and Register<a class="copiable-link" href="#Edit-and-Register"> &para;</a></span></h4>

<p>Replace, delete, and yank commands in normal mode save the characters in to registers.
</p>
<div class="example">
<pre class="example-preformatted">r/R         Character-level edit: Replace/Enter replace mode
X/x         Character-level edit: Delete at previous/current cursor
s           Character-level edit: Delete and enter the insert mode
~           Character-level edit: Swap case
D           Line-level edit: Delete (cut) from the cursor to the end
S           Line-level edit: Delete (cut) the line and enter the insert mode
C           Line-level edit: Delete from the cursor to the end and enter the insert mode
Y           Line-level edit: Yank the line
J           Line-level edit: Join the forward line to the current one
P/p         Document-level edit: Put (Paste) the text before/after the cursor
u/U         Document-level edit: Undo the last change / Undo all changes in the line
.           Repeat: The last edit command
&quot;&lt;reg&gt;      Use &lt;reg&gt; for d/y/p
&lt;C-a/x&gt;     Character-level edit: The first number after the cursor plus/minus 1
</pre></div>

<p>Recording-related command
</p>
<div class="example">
<pre class="example-preformatted">q&lt;reg&gt;      Recording: Record operations into &lt;reg&gt; until &quot;q&quot; is typed in normal mode
@&lt;reg&gt;      Recording: Run the operations in &lt;reg&gt;
@@          Repeat: The last @&lt;reg&gt;
</pre></div>

<p>In normal mode, &quot;d/c/y/&lt;/&gt;&quot; are operators.
If an operator is typed, it will wait for a motion, like &quot;h/j/k/l/w/W/e/E/b/B&quot;.
Type an operator twice indicates line-level edit.
</p>
<div class="example">
<pre class="example-preformatted">d/y         Delete (Cut) / Yank (Copy)
C           Delete (Cut/Change) to the end of the line and enter the insert mode
&lt;           Shift left
&gt;           Shift right
dd/yy       Line-level edit: Delete (Cut) / Yank
cc          Line-level edit: Delete and enter the insert mode
&lt;&lt;          Line-level edit: Shift left
&gt;&gt;          Line-level edit: Shift right
</pre></div>

<p>Register-related Command-line mode command 
</p>
<div class="example">
<pre class="example-preformatted">:reg            Show the registers
:messages       Show messages and errors
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Text-Object">
<h4 class="subsubsection"><span>7.1.1.4 Text Object<a class="copiable-link" href="#Text-Object"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">[a/i][w/W]          # a/inner word/WORD. Select a word/WORD with/without the space behind
[a/i][s/p/t]        # a/inner setence/paragraph/tag block
a[/{/(/&lt;/&quot;/'/`      # a [\{\( block with [\{\(
i[/{/(/&lt;/&quot;/'/`      # inner [\{\( block without [\{\(
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Keymapings-start-with-_0027Z_0027-and-_0027z_0027">
<h4 class="subsubsection"><span>7.1.1.5 Keymapings start with &rsquo;Z&rsquo; and &rsquo;z&rsquo;<a class="copiable-link" href="#Keymapings-start-with-_0027Z_0027-and-_0027z_0027"> &para;</a></span></h4>

<p>This is not full list. Use &lsquo;help z&lsquo; in vim to find all the keymappings.
</p>
<p>Quit vim
</p><div class="example">
<pre class="example-preformatted">ZQ          Close and quit vim without saving
ZZ          Save and close the current window
</pre></div>

<p>Folding
</p>
<div class="example">
<pre class="example-preformatted">za/A                Toggle a fold/folds recursively
zc/C                Close a fold/folds recursively
zd/D                Delete a fold/ folds recursively
zf&lt;motion&gt;/F        Create folds
zj                  Move to the start of the next fold
zo/O                Open a fold/folds recursively
</pre></div>

<p>Redraw the window
</p>
<div class="example">
<pre class="example-preformatted">zb/t/z      Redraw the cursor to the bottom/top/middle of the window

z.          Give spell suggestion 
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Keymappings-start-with-_0027g_0027">
<h4 class="subsubsection"><span>7.1.1.6 Keymappings start with &rsquo;g&rsquo;<a class="copiable-link" href="#Keymappings-start-with-_0027g_0027"> &para;</a></span></h4>

<p>Part of the commands have been listed.
</p>
<div class="example">
<pre class="example-preformatted">gd/gD       Document-level movement: Go to local/global decleration
ge/gE       Word-level movement: Backward to the end of the word/WORD
gg/G        Document-level movement: The first/last line
&lt;count&gt;g_   Line-level movement: Downward &lt;count&gt;-1 lines, on the last non-blank character
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Window">
<h4 class="subsubsection"><span>7.1.1.7 Window<a class="copiable-link" href="#Window"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">&lt;C-w&gt;s/v        Horizontal/Vertical split
&lt;C-w&gt;w          Switch
&lt;C-w&gt;h/j/k/l    Move left/down/up/right
&lt;C-w&gt;q          Quit
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Filter">
<h4 class="subsubsection"><span>7.1.1.8 Filter<a class="copiable-link" href="#Filter"> &para;</a></span></h4>

<p>Filter can lint to other formatters.
</p>
<div class="example">
<pre class="example-preformatted">!/=             Filter text through an external program 
</pre></div>

</div>
</div>
<div class="subsection-level-extent" id="Insert-Mode">
<h4 class="subsection"><span>7.1.2 Insert Mode<a class="copiable-link" href="#Insert-Mode"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">A/a             Enter insert mode and append at the end of the line/cursor
I/i             Enter insert mode and insert at the beginning of the line/cursor
O/o             Enter insert mode and insert a new line above/below the current line
</pre></div>

<p>Most commands in insert mode uses CTRL at first.
</p>
</div>
<div class="subsection-level-extent" id="Command_002dLine-Mode">
<h4 class="subsection"><span>7.1.3 Command-Line Mode<a class="copiable-link" href="#Command_002dLine-Mode"> &para;</a></span></h4>

<p>Command-line mode can be entered from normal mode by typing &rsquo;:&rsquo;, &rsquo;/&rsquo;, &rsquo;?&rsquo;, &rsquo;!&rsquo;.
The above commands are related to command-line mode, while part of them works in normal mode.
</p>
<div class="example">
<pre class="example-preformatted">:&lt;command&gt;      Run &lt;command&gt; (Enter command-line mode)
Q               Enter Ex mode
</pre></div>

<ul class="mini-toc">
<li><a href="#Search" accesskey="1">Search</a></li>
<li><a href="#Substitute" accesskey="2">Substitute</a></li>
<li><a href="#vimgrep" accesskey="3">vimgrep</a></li>
</ul>
<div class="subsubsection-level-extent" id="Search">
<h4 class="subsubsection"><span>7.1.3.1 Search<a class="copiable-link" href="#Search"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">%               Line-level search: Forward to the `{[(` and jump to its match
/&lt;pattern&gt;      Document-level search: Forward for &lt;pattern&gt;
?&lt;pattern&gt;      Document-level search: Backward for &lt;pattern&gt;
n/N             Repeat: '/' or '?' in the same/opposite direction
*/#             Document-level search: Forward/Backward for the next word under the cursor
</pre></div>

</div>
<div class="subsubsection-level-extent" id="Substitute">
<h4 class="subsubsection"><span>7.1.3.2 Substitute<a class="copiable-link" href="#Substitute"> &para;</a></span></h4>
<p>The substitute command is 
</p><div class="example">
<pre class="example-preformatted">:[range]s[ubstitute]/&lt;pattern&gt;/&lt;string&gt;/[flags] [count]
</pre></div>

<p>It has one repeat single-character command in normal mode.
</p><div class="example">
<pre class="example-preformatted">&amp;               Repeat: The last substitute
</pre></div>

</div>
<div class="subsubsection-level-extent" id="vimgrep">
<h4 class="subsubsection"><span>7.1.3.3 vimgrep<a class="copiable-link" href="#vimgrep"> &para;</a></span></h4>

<p>vimgrep is the built-in search command in vim.
The results can be listed in quickfix window.
</p>
<div class="example">
<pre class="example-preformatted">:vimgrep /&lt;PATTERN&gt;/&lt;FLAGS&gt; &lt;FILES&gt;
:vimgrep /foo/g &lt;DIR&gt;/**        Search all foo patterns recursively in &lt;DIR&gt;
:cnext                          Search the next position
:cprevious                      Search the previous position
:clist                          List all matched patterns
:cwindow                        Open the quickfix window
</pre></div>


</div>
</div>
<div class="subsection-level-extent" id="Test-Vim-Script">
<h4 class="subsection"><span>7.1.4 Test Vim Script<a class="copiable-link" href="#Test-Vim-Script"> &para;</a></span></h4>

<p>Vim is an awesome editor with powerful plugin ecosystems.
Most of the time, the plugin can be directly used by downloading them into the directory.
The plugin manager, which is also a plugin, can add the other plugins in to the runtime directory of vim.
</p>
<p>This subsection is not about how to install and use plugins, but is related to how to write a plugin.
The goal of this post is to give a brief introduction on test Vim plugins like test a command line.
Specifically, test is the basic function if someone wants to write their custom plugin.
Test the source code of a well-known plugin is also a good way to learn the idea of other developers&rsquo; plugins.
</p>
<p>The plugin language of writing plugins is Vimscript.
There are at least two vim processes, one for edit, and the other for running test.
Although vim is an editor, it provides a non-interactive mode to run Vim scripts without open the window.
Redirect the output of vim to other command with pipeline in shell like this
</p>
<p><code class="code">vim -u NONE --not-a-term -c &quot;echoconsole \&quot;hello world \&quot;  | q&quot; &gt;&gt; vim2stdout.txt</code>
</p>
<p>where <code class="code">-u</code>, <code class="code">-c</code>, <code class="code">--not-a-term</code> are vim options.
The detail can be found in <code class="code">vim --help</code>.
<code class="code">echoconsole</code> is a vim command can be used to output a message, which is &quot;hello world&quot; in this case, to the terminal.
The output is redirect to a file vim2stdout.txt and the string &quot;hello world&quot; can be found in the file, with some other strings.
</p>
<p>In addition, a recommand method for unit test is to write a script with a test case, and redirect the output to the awk tool, such as
</p>
<p>vim -u -NOME &ndash;not-a-term -S &lt;run_test_file&gt; &lt;test_case&gt; | awk &lt;pattern&gt;
</p>
<p>Note that there must be <code class="code">echoconsole</code> and <code class="code">quit</code> in the &lt;run_test_file&gt;.
</p>
<p>Debug the unit test of vim plugin can be implemented by the <code class="code">clientserver</code> feature of Vim.
There is a good plugin <a class="url" href="https://github.com/vim-scripts/BreakPts">breakpts</a>.
</p>
</div>
<div class="subsection-level-extent" id="Vim-Distribution">
<h4 class="subsection"><span>7.1.5 Vim Distribution<a class="copiable-link" href="#Vim-Distribution"> &para;</a></span></h4>

<p>Vim is one of the most famous editors in the world with powerful scalability.
However, Vim is extremely unfriendly for newbies, especially for those who uses graphical user interfaces (GUI).
NeoVim is a new version of Vim.
It is community-driven and deprecates lots of old-fashions in Vim.
</p>
<p>Due to the extensibility of Vim and Neovim, lots of developers contribute thousands of plugins for them.
So many plugins give both Vim and Neovim unlimited possibilities, but they also dazzle newbies who want to try these famous editors and don&rsquo;t know how to select a suitable configuration that meet their requirements.
</p>
<p>To solve this problem, recently, multiple developers and open source projects provide community-driven out-of-box configurations for Vim.
The relationship between these projects and Vim (or Neovim) is like the relationship between a Linux distribution and the kernel.
Therefore, I call these projects as &quot;Vim distributions&quot;, which means they use Vim (or Neovim) as the &quot;editor kernel&quot;.
The development of Vim distribution is more easier then before, thanks to the language server protocol (LSP).
The follows are some Vim distributions.
</p>
<ul class="mini-toc">
<li><a href="#SpaceVim" accesskey="1">SpaceVim</a></li>
<li><a href="#LunarVim" accesskey="2">LunarVim</a></li>
<li><a href="#NvChad" accesskey="3">NvChad</a></li>
<li><a href="#Doom_002dnvim" accesskey="4">Doom-nvim</a></li>
</ul>
<div class="subsubsection-level-extent" id="SpaceVim">
<h4 class="subsubsection"><span>7.1.5.1 SpaceVim<a class="copiable-link" href="#SpaceVim"> &para;</a></span></h4>

<p><a class="url" href="https://spacevim.org">SpaceVim</a> is inspired by spacemacs.
It is community-driven and provides layers to encapsulated the low-level configuration of Vim/Neovim.
Each layer in SpaceVim indicates a collection of plugins that provides a similar function.
Users can choose different plugins for the layer.
However, although SpaceVim change the &lt;leader&gt; to &lt;Space&gt;, it lacks a local easy-to-use document about all the keybindings (like vim).
SpaceVim provides a new configuration interface that uses &lsquo;.toml&lsquo; in the directory &lsquo;~/.Spacevim.d/&lsquo;.
SpaceVim is only distribution that can support both Vim and NeoVim.
</p>
</div>
<div class="subsubsection-level-extent" id="LunarVim">
<h4 class="subsubsection"><span>7.1.5.2 LunarVim<a class="copiable-link" href="#LunarVim"> &para;</a></span></h4>

<p><a class="url" href="https://www.lunarvim.org/">LunarVim</a>, or lvim in short, is another distribution that only supports Neovim.
It needs npm, node, and cargo as the prerequisites.
LunarVim is also community-driven and provides good support for multiple languages.
It provides a shortcut named as lvim in &lsquo;.local/bin/&lsquo;.
</p>
</div>
<div class="subsubsection-level-extent" id="NvChad">
<h4 class="subsubsection"><span>7.1.5.3 NvChad<a class="copiable-link" href="#NvChad"> &para;</a></span></h4>

<p><a class="url" href="https://nvchad.com/">NvChad</a> is a pure lua distribution with a customized colorscheme.
The aim of NvChad is to be a &quot;basic configuration&quot;, so the configuration logic of NvChad is pretty simple.
It is quitely easy to extend.
</p>
</div>
<div class="subsubsection-level-extent" id="Doom_002dnvim">
<h4 class="subsubsection"><span>7.1.5.4 Doom-nvim<a class="copiable-link" href="#Doom_002dnvim"> &para;</a></span></h4>

<p><a class="url" href="https://github.com/doom-neovim/doom-nvim">Doom-nvim</a> is also inspired by an emacs-based project.
It also proposes modules that includes plugins and keybindings.
The prerequisites includes npm and tree-sitter, which are both based on javascript.
If the Linux does not contains the prerequisites, the installation would have some problem.
</p>
</div>
</div>
</div>
<div class="section-level-extent" id="Micro-Editor">
<h3 class="section"><span>7.2 Micro Editor<a class="copiable-link" href="#Micro-Editor"> &para;</a></span></h3>

<p>Micro is a easily used terminal editor with intuitive key bindings as well as modern build-in features, including command line, auto-pair and linter.
</p>
<p>Install it in Debian (Test on Debian 12)
</p>
<p><code class="code">sudo apt install micro</code>
</p>
<p>A universal installation method for most Linux distributions
</p>
<p><code class="code">mkdir ~/bin</code>
<code class="code">cd ~/bin</code>
<code class="code">curl https://getmic.ro | bash</code>
</p>
<p>The configuration files are in <code class="code">~/.config/micro/*</code>
</p>
<p>The recommended plugins are follows
</p><ul class="itemize mark-bullet">
<li>linter (default installation)
</li><li>filemanager
</li><li>wc
</li><li>quickfix
</li></ul>

<p>The linter requires out-of-box support for each language (see, <code class="code">help linter</code> in the command line mode).
Enter the command line mode by typing <code class="code">&lt;C-e&gt;</code>, run
</p>
<p><code class="code">plugin install filemanager wc quickfix</code>
</p>
<ul class="mini-toc">
<li><a href="#Configuration" accesskey="1">Configuration</a></li>
</ul>
<div class="subsection-level-extent" id="Configuration">
<h4 class="subsection"><span>7.2.1 Configuration<a class="copiable-link" href="#Configuration"> &para;</a></span></h4>

<p>Micro uses &lsquo;json&lsquo; as the configuration file.
The follows are the default keymappings for it.
</p>
<div class="example">
<pre class="example-preformatted">{
  // The keymappings both can be used in normal pane and command pane.
    &quot;Ctrl-a&quot;:          &quot;SelectAll&quot;,
    &quot;Ctrl-b&quot;:          &quot;ShellMode&quot;,
    &quot;Ctrl-c&quot;:          &quot;CopyLine|Copy&quot;,
    &quot;Ctrl-d&quot;:          &quot;DuplicateLine&quot;,
    &quot;Ctrl-e&quot;:          &quot;CommandMode&quot;,
    &quot;Ctrl-f&quot;:          &quot;Find&quot;,
    &quot;Ctrl-g&quot;:          &quot;ToggleHelp&quot;,
    &quot;Ctrl-h&quot;:          &quot;Backspace&quot;,
    &quot;Ctrl-j&quot;:          &quot;PlayMacro&quot;,
    &quot;Ctrl-k&quot;:          &quot;CutLine&quot;,
    &quot;Ctrl-l&quot;:          &quot;command-edit:goto &quot;,
    &quot;Ctrl-n&quot;:          &quot;FindNext&quot;,
    &quot;Ctrl-o&quot;:          &quot;OpenFile&quot;,
    &quot;Ctrl-p&quot;:          &quot;FindPrevious&quot;,
    &quot;Ctrl-q&quot;:          &quot;Quit&quot;,
    &quot;Ctrl-r&quot;:          &quot;ToggleRuler&quot;,
    &quot;Ctrl-s&quot;:          &quot;Save&quot;,
    &quot;Ctrl-t&quot;:          &quot;AddTab&quot;,
    &quot;Ctrl-u&quot;:          &quot;ToggleMacro&quot;,
    &quot;Ctrl-v&quot;:          &quot;Paste&quot;,
    &quot;Ctrl-w&quot;:          &quot;NextSplit&quot;,
    &quot;Ctrl-x&quot;:          &quot;Cut&quot;,
    &quot;Ctrl-y&quot;:          &quot;Redo&quot;,
    &quot;Ctrl-z&quot;:          &quot;Undo&quot;,

    &quot;Alt-F&quot;:          &quot;FindLiteral&quot;,
    &quot;Alt-a&quot;:          &quot;StartOfLine&quot;,
    &quot;Alt-b&quot;:          &quot;WordLeft&quot;,
    &quot;Alt-c&quot;:          &quot;RemoveAllMultiCursors&quot;,
    &quot;Alt-e&quot;:          &quot;EndOfLine&quot;,
    &quot;Alt-f&quot;:          &quot;WordRight&quot;,
    &quot;Alt-g&quot;:          &quot;ToggleKeyMenu&quot;,
    &quot;Alt-m&quot;:          &quot;SpawnMultiCursorSelect&quot;,
    &quot;Alt-n&quot;:          &quot;SpawnMultiCursor&quot;,
    &quot;Alt-p&quot;:          &quot;RemoveMultiCursor&quot;,
    &quot;Alt-x&quot;:          &quot;SkipMultiCursor&quot;,
    &quot;Alt-{&quot;:          &quot;ParagraphPrevious&quot;,
    &quot;Alt-}&quot;:          &quot;ParagraphNext&quot;,
    &quot;Alt-,&quot;:          &quot;PreviousTab&quot;,
    &quot;Alt-.&quot;:          &quot;NextTab&quot;,

    &quot;CtrlUp&quot;:         &quot;CursorStart&quot;,
    &quot;CtrlDown&quot;:       &quot;CursorEnd&quot;,

    &quot;AltUp&quot;:          &quot;MoveLinesUp&quot;,
    &quot;AltDown&quot;:        &quot;MoveLinesDown&quot;,

    &quot;Alt-CtrlH&quot;:      &quot;DeleteWordLeft&quot;,

    &quot;CtrlShiftUp&quot;:    &quot;SelectToStart&quot;,
    &quot;CtrlShiftDown&quot;:  &quot;SelectToEnd&quot;,
    &quot;CtrlShiftRight&quot;: &quot;SelectWordRight&quot;,
    &quot;CtrlShiftLeft&quot;:  &quot;SelectWordLeft&quot;,

    &quot;AltShiftUp&quot;:     &quot;SpawnMultiCursorUp&quot;,
    &quot;AltShiftDown&quot;:   &quot;SpawnMultiCursorDown&quot;,
    &quot;AltShiftLeft&quot;:   &quot;SelectToStartOfTextToggle&quot;,
    &quot;AltShiftRight&quot;:  &quot;SelectToEndOfLine&quot;,

    // Keymapping for terminal mode
   &quot;terminal&quot;: {
          &quot;&lt;Ctrl-q&gt;&lt;Ctrl-q&gt;&quot;: &quot;Exit&quot;,
          &quot;&lt;Ctrl-e&gt;&lt;Ctrl-e&gt;&quot;: &quot;CommandMode&quot;,
          &quot;&lt;Ctrl-w&gt;&lt;Ctrl-w&gt;&quot;: &quot;NextSplit&quot;
      },
}
</pre></div>
<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Version-Control">
<div class="nav-panel">
<p>
Next: <a href="#Server" accesskey="n" rel="next">Server</a>, Previous: <a href="#Editor" accesskey="p" rel="prev">Editor</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Version-Control-1"><span>8 Version Control<a class="copiable-link" href="#Version-Control-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#git" accesskey="1">git</a></li>
</ul>
<div class="section-level-extent" id="git">
<h3 class="section"><span>8.1 git<a class="copiable-link" href="#git"> &para;</a></span></h3>

<ul class="mini-toc">
<li><a href="#Config" accesskey="1">Config</a></li>
<li><a href="#Branch" accesskey="2">Branch</a></li>
<li><a href="#Remote" accesskey="3">Remote</a></li>
<li><a href="#Submodule" accesskey="4">Submodule</a></li>
</ul>
<div class="subsection-level-extent" id="Config">
<h4 class="subsection"><span>8.1.1 Config<a class="copiable-link" href="#Config"> &para;</a></span></h4>

<p>git always uses &lsquo;&ndash;global&lsquo; option to config for all repos.
</p>
<div class="example">
<pre class="example-preformatted">git config --global user.name &lt;name&gt;    # Set user name
git config --global user.email &lt;email&gt;@gmail.com
                                        # Set user email

git config --global http.proxy &lt;proxy&gt;  # Set proxy of http to &lt;proxy&gt;
git config --global https.proxy &lt;proxy&gt; # Set proxy of https to &lt;proxy&gt;
git config --global --unset http.proxy  # Unset the http.proxy

git config --global core.editor &lt;editor&gt;
                                        # To set your editor:

git config --global diff.tool vimdiff   # Set vimdiff as the tool to edit diff

</pre></div>

<p>subsection Commit
</p>
<div class="example">
<pre class="example-preformatted">git init                            # Initialize an empty repo
git init --bare                     # Initialize a bare repo. It is useful for the dotfile projcet
git status                          # Show the changed and unstaged files
git add &lt;file&gt;                      # Add(Stage) &lt;file&gt;
git reset &lt;file&gt;                    # Remove &lt;file&gt; from the stage
git reset --hard                    # Remove all uncommitted changes
git rm &lt;file&gt;                       # Removes &lt;file&gt; from both git and system
git rm --cached                     # Removes &lt;file&gt; from git
git commit                          # Commit staged file, it opens an editor
git commit -m &quot;&lt;msg&gt;&quot;               # Commit with message &lt;msg&gt;
git commit --amend                  # Edit previous commit message

git log                             # Show the comment log
git log --oneline                   # Show the commit log in one line

git tag                             # List all tags
git tag -a v1.0 -m &quot;msg&quot;            # Create an annotated tag
git show &lt;tag&gt;                      # Show the description of &lt;tag&gt;
git tag --delete &lt;tag&gt;              # Delete the tag

git rebase -i &lt;commit_id&gt;           # Rebase commits from &lt;commit_id&gt; 

</pre></div>

</div>
<div class="subsection-level-extent" id="Branch">
<h4 class="subsection"><span>8.1.2 Branch<a class="copiable-link" href="#Branch"> &para;</a></span></h4>
<div class="example">
<pre class="example-preformatted">git branch                          # List branches 
git branch -a                       # List local and remote branches
git branch &lt;branch&gt;                 # Create branch
git branch -d &lt;branch&gt;              # Delete &lt;branch&gt;
git branch -m &lt;new-name&gt;            # Rename the branch

git checkout &lt;branch&gt;               # Checkout &lt;branch&gt;
git checkout &lt;branch&gt; &lt;file&gt;     # Checkout (copy) the file in &lt;branch&gt; to this branch
git merge &lt;branch&gt;                  # Merge &lt;branch&gt; to the current branch

git diff                            # Differences (unstaged files) between now and HEAD
git diff &lt;other&gt; &lt;branch&gt; -- &lt;file&gt;
                                    # Differences between the same file in &lt;other&gt; and &lt;branch&gt;
git diff -cached                    # Differences between staged files and HEAD
git difftool &lt;branch&gt; &lt;file&gt;        # Use difftool (e.g., vimdiff) to open and edit the file

git stash                           # Save uncommitted changes into stash
git stash push -m &quot;&lt;msg&gt;&quot;           # Stash changes with a message:
git stash list                      # List all the stashed changes:

git stash pop                       # Pop changes from stagh
</pre></div>

</div>
<div class="subsection-level-extent" id="Remote">
<h4 class="subsection"><span>8.1.3 Remote<a class="copiable-link" href="#Remote"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">git remote add &lt;remote&gt; &lt;link&gt;      # Add a remote reposiory named as &lt;remote&gt; 
git remote                          # Show remote
git remote -v                       # Show more details about the remote 
git remote rm &lt;remote&gt;              # Remove a remote repository
git remote set-url &lt;remote&gt; &lt;link&gt;  # Change URL to &lt;link&gt; for &lt;remote&gt;

git clone &lt;link&gt; &lt;path&gt;             # Clone a remote repo to local &lt;Path&gt;

# The following commands require git-remote-add
git push                            # Push this branch to the remote origin repo
git push &lt;remote&gt; &lt;remotebranch&gt;:&lt;localbranch&gt;
                                    # Push &lt;localbranch&gt; to the &lt;remotebranch&gt; from the &lt;remote&gt; repo
git fetch                           # Fetch remote to the branch
git pull                            # Fetch and merge
git pull &lt;remote&gt; &lt;remotebranch:&lt;localbranch&gt;
                                    # Pull &lt;remotebranch&gt; from &lt;remote&gt; to &lt;localbranch&gt;
</pre></div>

</div>
<div class="subsection-level-extent" id="Submodule">
<h4 class="subsection"><span>8.1.4 Submodule<a class="copiable-link" href="#Submodule"> &para;</a></span></h4>

<div class="example">
<pre class="example-preformatted">git submodule update --init --recursive                 # Update all submodules:

# git command for prompt in shell
git status --short | wc -l          # Get the number of modified file in git
git branch --show-current           # Show the name of current branch
git rev-list --count @{upstream}..HEAD  
                                        # Count commits that local branch have but upstream does not 
</pre></div>
<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Server">
<div class="nav-panel">
<p>
Next: <a href="#Network" accesskey="n" rel="next">Network</a>, Previous: <a href="#Version-Control" accesskey="p" rel="prev">Version Control</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Server-1"><span>9 Server<a class="copiable-link" href="#Server-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#Termux" accesskey="1">Termux</a></li>
</ul>
<div class="section-level-extent" id="Termux">
<h3 class="section"><span>9.1 Termux<a class="copiable-link" href="#Termux"> &para;</a></span></h3>

<p>Termux is an open-source Linux emulator in android.
It uses pkg as the package manager.
By downloading packages, Termux supports network servers.
</p>
<ul class="mini-toc">
<li><a href="#ssh" accesskey="1">ssh</a></li>
</ul>
<div class="subsection-level-extent" id="ssh">
<h4 class="subsection"><span>9.1.1 ssh<a class="copiable-link" href="#ssh"> &para;</a></span></h4>

<p>ssh in Termux uses 8022 port by default.
To connect it, use 
<code class="code">ssh -p 8022 &lt;username&gt;@&lt;IP&gt;</code>
</p>
<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Network">
<div class="nav-panel">
<p>
Next: <a href="#SDR" accesskey="n" rel="next">SDR</a>, Previous: <a href="#Server" accesskey="p" rel="prev">Server</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Network-1"><span>10 Network<a class="copiable-link" href="#Network-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#iw" accesskey="1">iw</a></li>
<li><a href="#Clash" accesskey="2">Clash</a></li>
<li><a href="#Clash-for-LAN" accesskey="3">Clash for LAN</a></li>
<li><a href="#snapdrop_002enet" accesskey="4">snapdrop.net</a></li>
</ul>
<div class="section-level-extent" id="iw">
<h3 class="section"><span>10.1 iw<a class="copiable-link" href="#iw"> &para;</a></span></h3>

<p>iw is a configuration tool for mac80211 in Linux kernel with netlink
The code tree of <code class="code">iw.c</code> in iw is
</p>
<ul class="itemize mark-bullet">
<li>main
    <ul class="itemize mark-minus">
<li>version
    </li><li>nl80211_init
        <ul class="itemize mark-minus">
<li>nl_socket_alloc
        </li><li>nl_socket_free
        </li><li>nl_socket_set_buffer_size
        </li></ul>
</li><li>usage
        <ul class="itemize mark-minus">
<li>__usage_cmd
        </li><li>usage_options
        </li></ul>
</li><li>__handle_cmd
        <ul class="itemize mark-minus">
<li>error_handler
        </li><li>finish_handler
        </li><li>ack_handler
        </li><li>register_handler
        </li><li>valid_handler
        </li><li>phy_lookup
        </li></ul>
</li><li>phy_lookup
    </li><li>nl80211_cleanup
    </li></ul>
</li><li>TOPLEVEL
    <ul class="itemize mark-minus">
<li>print_help
    </li></ul>
</li><li>handle_cmd
    <ul class="itemize mark-minus">
<li>__handle_cmd
    </li></ul>
</li><li>usage_cmd
    <ul class="itemize mark-minus">
<li>__usage_cmd
    </li></ul>
</li></ul>

</div>
<div class="section-level-extent" id="Clash">
<h3 class="section"><span>10.2 Clash<a class="copiable-link" href="#Clash"> &para;</a></span></h3>

<p>clash is a tunnel in Go.
</p>
<ul class="mini-toc">
<li><a href="#Installation-1" accesskey="1">Installation</a></li>
<li><a href="#Basic-Usage" accesskey="2">Basic Usage</a></li>
<li><a href="#Autostart" accesskey="3">Autostart</a></li>
</ul>
<div class="subsection-level-extent" id="Installation-1">
<h4 class="subsection"><span>10.2.1 Installation<a class="copiable-link" href="#Installation-1"> &para;</a></span></h4>

<p>openSUSE contains clash in its repository, so it can be downloaded directly
</p>
<p><code class="code">sudo zypper in clash</code>
</p>
<p>Debian repository does not contain clash, so it can be downloaded from [Github release](https://github.com/Dreamacro/clash/releases).
It also can be downloaded in command.
As an example
</p>
<p><code class="code">wget https://github.com/Dreamacro/clash/releases/download/v1.18.0/clash-linux-amd64-v1.18.0.gz</code>
<code class="code">mv clash-linux-amd64-v1.18.0.gz clash</code>
</p>
</div>
<div class="subsection-level-extent" id="Basic-Usage">
<h4 class="subsection"><span>10.2.2 Basic Usage<a class="copiable-link" href="#Basic-Usage"> &para;</a></span></h4>

<p>If clash is run in the user space, copy the <code class="code">config.yaml</code> file to <code class="code">~/.config/clash/</code> directory and run
</p>
<p><code class="code">clash</code>
</p>
<p>Clash will download the <code class="code">Country.mmdb</code> file by itselef and load the configuration in <code class="code">~/.config/clash/</code>.
</p>
</div>
<div class="subsection-level-extent" id="Autostart">
<h4 class="subsection"><span>10.2.3 Autostart<a class="copiable-link" href="#Autostart"> &para;</a></span></h4>

<p>Clash support auto-start after opening the system.
In openSUSE, the download version of clash has a systemd service with <code class="code">/lib/system/system/clash.service</code> to support the auto-start process.
This service is based on systemd, so it works for openSUSE and other distributions that uses systemd as the init process.
Different from manually run clash, the systemd will load the configuration in the directory <code class="code">/etc/clash/</code> by default.
So move the configuration file and mmdb file in the above directory by
</p>
<p><code class="code">sudo mv /path/to/config/file /etc/clash/</code>
<code class="code">sudo mv /path/to/Country.mmdb /etc/clash</code>
</p>
<p>Then, enable and start clash service
</p>
<p><code class="code">systemclt enable clash</code>
<code class="code">systemclt start clash</code>
</p>
<p>The final process is to config the system-level network setting or program-level network setting to use the clash service.
</p>
</div>
</div>
<div class="section-level-extent" id="Clash-for-LAN">
<h3 class="section"><span>10.3 Clash for LAN<a class="copiable-link" href="#Clash-for-LAN"> &para;</a></span></h3>
 
<p>Clash can support connection from devices in the local area network (LAN).
To enable it, just edit the config.yaml file and set the <code class="code">allow-lan</code> to <code class="code">true</code>.
Then open clash with manual
</p>
<p><code class="code">clash -d ~/.config/clash/</code>
</p>
</div>
<div class="section-level-extent" id="snapdrop_002enet">
<h3 class="section"><span>10.4 snapdrop.net<a class="copiable-link" href="#snapdrop_002enet"> &para;</a></span></h3>

<p><a class="url" href="https://snapdrop.net">snapdrop</a> is an easily-used point-to-point file transfer in the web browser.
Open the link of snapdrop in the same network.
The website can identify all devices in the same network. 
Just drop the file to the target.
</p><hr>
</div>
</div>
<div class="chapter-level-extent" id="SDR">
<div class="nav-panel">
<p>
Next: <a href="#Input-Method" accesskey="n" rel="next">Input Method</a>, Previous: <a href="#Network" accesskey="p" rel="prev">Network</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="SDR-1"><span>11 SDR<a class="copiable-link" href="#SDR-1"> &para;</a></span></h2>

<ul class="mini-toc">
<li><a href="#GNURadio-Period-transmisstion" accesskey="1">GNURadio Period transmisstion</a></li>
</ul>
<div class="section-level-extent" id="GNURadio-Period-transmisstion">
<h3 class="section"><span>11.1 GNURadio Period transmisstion<a class="copiable-link" href="#GNURadio-Period-transmisstion"> &para;</a></span></h3>

<ul class="mini-toc">
<li><a href="#Introduction" accesskey="1">Introduction</a></li>
<li><a href="#GNURadio-Tag" accesskey="2">GNURadio Tag</a></li>
<li><a href="#USRP-Time-Control" accesskey="3">USRP Time Control</a></li>
</ul>
<div class="subsection-level-extent" id="Introduction">
<h4 class="subsection"><span>11.1.1 Introduction<a class="copiable-link" href="#Introduction"> &para;</a></span></h4>

<p>Period transmission in GNURadio/USRP platform is the basic function to support time-related systems, such as 
</p><ul class="itemize mark-minus">
<li>Time delay measurement between multiple USRPs
</li><li>Time synchronization in designing distributed MIMO systems
</li><li>TX/RX switch at the same antenna
</li><li>Feedback design
</li></ul>

<p>The period transmission is based on <a class="url" href="https://wiki.gnuradio.org/index.php/USRP_Sink">burst transmission</a> with &quot;tx_time&quot; tag.
All the functions have been tested on USRP N310 with GNURadio 3.7.13 and UHD 3.15.
</p>
</div>
<div class="subsection-level-extent" id="GNURadio-Tag">
<h4 class="subsection"><span>11.1.2 GNURadio Tag<a class="copiable-link" href="#GNURadio-Tag"> &para;</a></span></h4>

<p><a class="url" href="https://wiki.gnuradio.org/index.php/Stream_Tags">GNURadio tag</a> is an isosynchronous data that runs parallel to the main data stream. 
</p>
<p>uhd_sink block supports two tags &quot;tx_sob&quot; and &quot;tx_eob&quot; for burst transmission.
&quot;tx_sob&quot; tag means &quot;start of burst&quot; that should be added into the first sample of a frame burst.
&quot;tx_eob&quot; means &quot;end of burst&quot; that should be added into the last sample.
If UHD receives &quot;tx_eob&quot;, the TX mode of USRP will be done, until it receives a &quot;tx_sob&quot; tag.
The &quot;tx_sob&quot; and &quot;tx_eob&quot; value should simply be PMT_T.
As an example, user can use &lsquo;add_item_tag&lsquo; provided by GNURadio to add the &quot;tx_sob&quot; tag in C++.
</p>
<div class="example">
<pre class="example-preformatted">add_item_tag(0, // Port number
             nitems_written(0) + i, // Offset
             pmt::mp(&quot;tx_sob&quot;), // Key
             pmt::PMT_T // Value
        );
</pre></div>

<p>In the above code, the &quot;tx_sob&quot; tag will be added at port 0 with <code class="code">nitems_written(0) + i</code> offset.
Note that add tag can also in python.
</p>
<p>Please refer to <a class="url" href="https://wiki.gnuradio.org/index.php/Stream_Tags">this page</a> for a detail description about GNURadio tag.
</p>
<p>The third important tag is &quot;tx_time&quot; which is a PMT encoded tuple with two components. 
The first item in the tuple is the PMT encoded uint64 epoch time in seconds. 
The second item in the tuple is the PMT encoded double fractional epoch time. 
The following example can be used to transfer the time from double to a PMT tuple in C++.
</p>
<div class="example">
<pre class="example-preformatted">double d_next_time = 1.0;
uint64_t t_int = (uint64_t)d_next_time;
double t_double = d_next_time - t_int;
pmt::pmt_t tstamp_tuple = pmt::make_tuple(pmt::from_uint64(t_int), pmt::from_double(t_double));
</pre></div>

<p>The &quot;tx_time&quot; tag will be added at port 0 with <code class="code">nitems_written(0) + i</code> offset.
</p>
<div class="example">
<pre class="example-preformatted">add_item_tag(0, // Port number
             nitems_written(0) + i, // Offset
             pmt::mp(&quot;tx_time&quot;), // Key
             tstamp_tuple // Value
        );
</pre></div>

<p>Note that if the user directly add the &quot;tx_time&quot; tag with the offset is zero, the USRP will have a bug with unknown reason that the first two burst frames are not sent with the predefined time by &quot;tx_time&quot;.
</p>
<p>With the help of the above tags, the user can control the transmit time of a burst frame with a fix length, so it can be used to implement period transmission.
</p>
</div>
<div class="subsection-level-extent" id="USRP-Time-Control">
<h4 class="subsection"><span>11.1.3 USRP Time Control<a class="copiable-link" href="#USRP-Time-Control"> &para;</a></span></h4>

<p>The last things is to set the time of USRP with gr-uhd, if the time has error, you may get a &quot;L&quot; error in the transmitter. 
&quot;L&quot; means a late packet in the TX chain. 
More details please refer to <a class="url" href="https://files.ettus.com/manual/page_usrp_x3x0_config.html">System Configuration for USRP X3x0 Series</a>.
</p>
<p>The following code snapshot is used for time setting for both the USRP source and sink in python API.
</p>
<div class="example">
<pre class="example-preformatted"># Set time to 0 for each USRP
self.uhd_usrp_sink_0.set_time_next_pps(uhd.time_spec(0.0))
self.uhd_usrp_source_0.set_time_next_pps(uhd.time_spec(0.0))

time.sleep(1) # Wait for the PPS signal

# USRP sink sends at time 2.0
# USRP source receives at time 1.0
# This time can be set to any other times
self.uhd_usrp_sink_0.set_start_time(uhd.time_spec(2.0))
self.uhd_usrp_source_0.set_start_time(uhd.time_spec(1.0))
</pre></div>

<hr>
</div>
</div>
</div>
<div class="chapter-level-extent" id="Input-Method">
<div class="nav-panel">
<p>
Previous: <a href="#SDR" accesskey="p" rel="prev">SDR</a>, Up: <a href="#index" accesskey="u" rel="up">Contents</a> &nbsp; </p>
</div>
<h2 class="chapter" id="Input-Method-1"><span>12 Input Method<a class="copiable-link" href="#Input-Method-1"> &para;</a></span></h2>

<p>This chapter is related to the chinese input method.
In openSUSE, the fcitx5 framework can be installed from the repository with command
</p>
<p><code class="code">sudo zypper in fcitx5</code>
</p>
<p>This command will install a GUI configuration tool <code class="code">fcitx5-configtool</code>.
The chinese input method can be chosen from it.
</p>
</div>
</div>



</body>
</html>
